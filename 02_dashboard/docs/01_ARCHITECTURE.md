# 01_ARCHITECTURE.md

## 1. システム概要

本システムは、展示会・セミナーにおけるリードマネジメントプロセス（アンケート作成・管理、名刺データ化、お礼メール送信、データエクスポート、グループ管理、請求書詳細表示）を一元的に支援するWEBアプリケーションです。効率的な業務遂行とデータの一元管理を目的としています。

## 2. 設計原則

本システムの設計は、以下の主要な原則に基づいています。

### 2.1. UIのモジュール化/コンポーネント化

*   **目的**: UIの一貫性、再利用性、保守性の向上。
*   **アプローチ**:
    *   **共通UI要素の分離**: ヘッダー、サイドバー、フッターなどの共通UI要素は、`common/` ディレクトリ内の独立したHTMLファイルとして定義されています。これらはJavaScript (`utils.js` の `loadCommonHtml` 関数) を通じて、**すべての主要なアプリケーションページに**動的に組み込まれます。
    *   **コンポーネントベースのUI開発**: モーダル (`modals/` ディレクトリのHTMLファイルと `modalHandler.js`) やテーブル (`tableManager.js`) など、複雑なUI要素も独立したモジュールとして管理されます。これにより、各UI要素が単一の責務を持ち、独立して開発・テスト・保守が可能です。
    *   **テンプレートの活用**: HTMLの `<template>` 要素をJavaScriptから利用し、動的にUI要素を生成することで、再利用可能なUIコンポーネントを効率的に構築しています。

### 2.2. 関心の分離とレイヤー化

*   **目的**: コードの疎結合化、保守性、拡張性の向上。
*   **アプローチ**:
    *   **UI層**: ユーザーインターフェースの描画とユーザーインタラクションに責任を持ちます（例: `surveyRenderer.js`, `tableManager.js`）。
    *   **サービス層**: データ取得、永続化、ビジネスロジックといったデータ操作に責任を持ちます。UI層から独立しており、データソースの変更がUIに影響を与えにくい設計です（例: `surveyService.js`, `groupService.js`）。
    *   **ユーティリティ層**: アプリケーション全体で利用される共通機能（スクロール制御、トースト通知、クリップボード操作など）をカプセル化し、他のモジュールがこれらを再利用することで、コードの重複を避け、一貫したUI/UXを提供します（例: `utils.js`）。
    *   **メインアプリケーション層**: アプリケーションのエントリーポイントとして、各モジュールの初期化と連携を管理します（例: `main.js`）。

### 2.3. 堅牢性と信頼性

*   **目的**: システムの安定稼働とデータ整合性の確保を目指します。
*   **アプローチ**:
    *   **冪等性制御**: クライアントからの多重送信による意図しない再処理を防止するため、リクエストに一意の冪等性キーを付与し、サーバー側で同一キーの再利用を制御・管理する設計思想を採用しています。
    *   **エラーハンドリング**: 各モジュールにおいて、非同期処理や外部リソースへのアクセス時に適切なエラーハンドリングを実装することを目指しています。

### 2.4. ユーザーエクスペリエンスへの配慮

*   **目的**: 直感的で使いやすいアプリケーションの提供。
*   **アプローチ**:
    *   レスポンシブデザイン、直感的なUI、ローディングインジケーター、トースト通知、詳細なページネーション、ソート機能など、ユーザーがスムーズにアプリケーションを利用できるような多くの配慮がなされています。

## 3. 主要コンポーネント

本システムは、以下の主要なコンポーネントで構成されています。

*   **共通UIコンポーネント**: ヘッダー、サイドバー、フッター、モーダル、トースト通知など、アプリケーション全体で再利用されるUI要素。
*   **ページ固有UIコンポーネント**: アンケート一覧テーブル、アンケート作成フォームなど、特定のページに特化したUI要素。
*   **データサービス**: アンケートデータ、グループデータなど、各エンティティのデータ取得・操作を抽象化するサービス。
*   **ユーティリティ**: スクロール制御、クリップボード操作など、アプリケーション全体で利用される汎用的な機能。

## 4. データモデル

詳細については、[データ構造定義書](architecture/02_data_model.md)を参照してください。

## 5. インフラストラクチャ

本システムは、AWSをインフラ基盤とし、以下の主要な技術スタックで構成されています。

*   **Webサーバー**: nginx
*   **APサーバー/言語**: PHP / Laravel
*   **DB**: MySQL
*   **キャッシュ/セッションストア**: Redis
*   **フロントエンド**: JavaScript, jQuery, Vue.js/React (SPAフロントエンド), Tailwind CSS, flatpickr, Sortable.js 等

## 6. 技術選定理由

（このセクションは、将来的に具体的な技術選定の理由を追記する予定です。）
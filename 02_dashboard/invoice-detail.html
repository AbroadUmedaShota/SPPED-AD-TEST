<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>請求書詳細 - SPEED AD</title>
  <link rel="icon" href="assets/svg/speedad_logo.svg" type="image/svg+xml">
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="service-top-style.css">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link as="style"
    href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900&family=Noto+Sans+JP:wght@400;500;700;900"
    onload="this.rel='stylesheet'" rel="stylesheet">
  <style>
    .invoice-section {
      background-color: white;
      border-radius: 0.75rem;
      border: 1px solid var(--outline-variant, #e5e7eb);
      padding: 1.75rem;
      margin-bottom: 1.75rem;
    }

    .invoice-info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 1rem 1.5rem;
    }

    .invoice-table-container {
      overflow-x: auto;
    }

    .invoice-table {
      width: 100%;
      border-collapse: collapse;
    }

    .invoice-table th,
    .invoice-table td {
      border: 1px solid var(--outline-variant, #e5e7eb);
      padding: 0.75rem;
      text-align: left;
      font-size: 0.9rem;
    }

    .invoice-table th {
      background-color: var(--surface-variant, #f4f4f5);
      font-weight: 600;
    }

    .invoice-table tfoot tr>th {
      text-align: right;
    }

    .message-overlay {
      position: absolute;
      inset: 0;
      background-color: rgba(255, 255, 255, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    /* --- Invoice Sheet CSS (from User) --- */
    /* --- 用紙（A4サイズ）設定 --- */
    .invoice-sheet {
      width: 210mm;
      min-height: 297mm;
      background-color: #fff;
      margin: 0 auto 20px auto;
      /* 画面表示用に下に余白 */
      padding: 15mm 15mm;
      box-sizing: border-box;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
      position: relative;
      color: #333;
      /* Default text color override for sheet stuff */
    }

    /* --- 共通テーブル設定 --- */
    .invoice-sheet table {
      width: 100%;
      border-collapse: collapse;
      border-spacing: 0;
      font-size: 9pt;
    }

    .invoice-sheet th,
    .invoice-sheet td {
      border: 1px solid #000;
      padding: 2px 5px;
      /* パディングを少し詰める */
      vertical-align: middle;
    }

    /* カラー設定 */
    .invoice-sheet .bg-header {
      background-color: #9bc2e6;
      text-align: center;
      font-weight: normal;
    }

    /* 明細行のシマシマ（ゼブラ）設定 */
    /* tbody内の偶数番目の行に色をつける */
    .invoice-sheet .details-table tbody tr:nth-child(even) {
      background-color: #e3eff9;
    }

    /* 文字配置ユーティリティ */
    .invoice-sheet .text-center {
      text-align: center;
    }

    .invoice-sheet .text-right {
      text-align: right;
    }

    .invoice-sheet .text-left {
      text-align: left;
    }

    .invoice-sheet .font-bold {
      font-weight: bold;
    }

    /* --- 1ページ目固有のスタイル --- */

    /* ヘッダー（日付・番号） */
    .invoice-sheet .header-info-table {
      width: auto;
      margin-left: auto;
      margin-bottom: 20px;
      font-size: 9pt;
    }

    .invoice-sheet .header-info-table th {
      width: 80px;
      text-align: right;
      font-weight: normal;
      background-color: transparent;
      border: none;
      padding-right: 5px;
    }

    .invoice-sheet .header-info-table td {
      text-align: right;
      border: none;
    }

    /* タイトル */
    .invoice-sheet h1.main-title {
      text-align: center;
      font-size: 22pt;
      letter-spacing: 1em;
      margin: 10px 0 30px 0;
      font-weight: bold;
      border-bottom: none;
      color: #000;
    }

    /* 宛名・差出人エリア */
    .invoice-sheet .top-section {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .invoice-sheet .recipient-area {
      width: 55%;
    }

    .invoice-sheet .recipient-table {
      width: 100%;
      border: none;
      margin-bottom: 10px;
    }

    .invoice-sheet .recipient-table td {
      border: none;
      border-bottom: 1px solid #000;
      padding: 5px;
      font-size: 11pt;
    }

    .invoice-sheet .recipient-name {
      text-align: center;
    }

    .invoice-sheet .recipient-suffix {
      width: 50px;
      text-align: right;
    }

    .invoice-sheet .greeting-text {
      font-size: 8pt;
      margin-top: 20px;
      text-align: right;
      line-height: 1.4;
    }

    .invoice-sheet .sender-area {
      width: auto;
      margin-left: auto;
      position: relative;
      font-size: 8pt;
      line-height: 1.3;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }

    .invoice-sheet .sender-area>div {
      text-align: left;
      white-space: nowrap;
    }

    .invoice-sheet .logo-img {
      display: block;
      width: 220px;
      height: auto;
      margin-bottom: 5px;
    }

    .invoice-sheet .hanko-img {
      position: absolute;
      top: -15px;
      right: 0px;
      width: 75px;
      height: 70px;
      opacity: 0.9;
      mix-blend-mode: multiply;
      z-index: 10;
    }

    /* 金額・口座情報エリア */
    .invoice-sheet .summary-container {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
    }

    .invoice-sheet .summary-left {
      width: 56%;
    }

    .invoice-sheet .summary-right {
      width: 42%;
    }

    .invoice-sheet .summary-table,
    .invoice-sheet .bank-table {
      height: 100%;
    }

    .invoice-sheet .summary-table th {
      width: 35%;
    }

    .invoice-sheet .summary-table td.amount-cell {
      text-align: right;
      border-right: none;
      padding-right: 2px;
    }

    .invoice-sheet .summary-table th,
    .invoice-sheet .summary-table td,
    .invoice-sheet .bank-table th,
    .invoice-sheet .bank-table td {
      padding: 5px;
      height: 25px;
      /* Ensure uniform height for calculation */
      box-sizing: border-box;
    }

    .invoice-sheet .summary-table th {
      width: 35%;
    }

    .invoice-sheet .bank-table th {
      width: 25%;
      font-size: 8pt;
      text-align-last: justify;
      text-align: justify;
      text-justify: inter-ideograph;
      padding-left: 10px;
      padding-right: 10px;
      white-space: nowrap;
    }

    .invoice-sheet .bank-table td {
      font-size: 9pt;
    }

    .invoice-sheet .total-amount-row th,
    .invoice-sheet .total-amount-row td {
      height: 60px;
      /* Adjusted to visually match right table */
    }

    .invoice-sheet .total-amount-row th {
      font-size: 11pt;
      text-align-last: center;
      text-align: center;
    }

    .invoice-sheet .total-amount {
      font-size: 18pt;
      font-weight: bold;
      margin-right: 5px;
    }

    .invoice-sheet .notes-area {
      display: flex;
      justify-content: space-between;
      font-size: 7pt;
      margin-bottom: 15px;
    }

    /* --- 明細テーブル共通 --- */
    .invoice-sheet .details-table {
      width: 100%;
      margin-top: 5px;
    }

    .invoice-sheet .details-table th {
      padding: 4px 0;
      border-bottom: 1px double #000;
      height: 20px;
    }

    /* 列幅設定 */
    .invoice-sheet .col-no {
      width: 5%;
      text-align: center;
    }

    .invoice-sheet .col-item1 {
      width: 25%;
    }

    .invoice-sheet .col-item2 {
      width: 25%;
    }

    .invoice-sheet .col-qty {
      width: 8%;
      text-align: right;
    }

    .invoice-sheet .col-price {
      width: 12%;
      text-align: right;
    }

    .invoice-sheet .col-amount {
      width: 15%;
      text-align: right;
    }

    /* Header Alignment Override */
    .invoice-sheet th.col-qty,
    .invoice-sheet th.col-price,
    .invoice-sheet th.col-amount {
      text-align: center;
    }

    /* 行の高さ設定 */
    /* 1ページ目は項目が少ないので少し余裕を持たせる */
    .invoice-sheet.page-1 .details-table td {
      height: 24px;
    }

    /* 2ページ目は行数が多いので少し詰める (21-62行 = 42行) */
    .invoice-sheet.page-2 .details-table td {
      height: 21px;
    }

    /* Spacer Row */
    .invoice-sheet .details-table tr.spacer-row td {
      border-left: 1px solid #000;
      border-right: 1px solid #000;
      border-top: none;
      border-bottom: none;
    }

    /* Subtotal Row */
    .invoice-sheet .details-table tr.subtotal-row td {
      background-color: #f0f0f0;
      font-weight: bold;
      text-align: center;
    }

    .invoice-sheet .details-table tr.subtotal-row td.col-amount {
      text-align: right;
    }

    /* Actually usually invoice lines have vertical borders. If I remove borders it looks like a gap. */
    /* Let's remove content borders but keep side borders if the design has side borders. */
    /* Looking at `seikyuusyo_sample.html` (not available), usually standard JP invoices have grid lines. */
    /* If `details-table` has `border-collapse`, removing border might show gaps. */
    /* I'll just remove top/bottom borders. */

    /* ページ番号 */
    /* ページ番号 */
    .invoice-sheet .page-number {
      position: absolute;
      bottom: 5mm;
      right: 15mm;
      font-size: 9pt;
    }

    /* --- 印刷設定 --- */
    @media print {
      body {
        background: none;
        padding: 0;
      }

      #main-content {
        padding: 0;
        margin: 0;
      }

      header,
      #breadcrumb-container,
      .invoice-section {
        display: none;
      }

      /* Hide dashboard UI */
      #invoice-sheet-container {
        display: block;
      }

      .invoice-sheet {
        width: 100%;
        height: auto;
        /* 印刷時は高さ自動 */
        box-shadow: none;
        margin: 0;
        padding: 15mm;
        page-break-after: always;
        /* ページごとに改ページ */
      }

      .invoice-sheet:last-child {
        page-break-after: auto;
      }
    }
  </style>

</head>

<body class="bg-background text-on-background" data-page-id="invoice-detail">
  <div class="relative flex min-h-screen flex-col overflow-x-hidden">
    <div id="mobileSidebarOverlay" class="mobile-sidebar-overlay lg:hidden"></div>
    <div id="header-placeholder"></div>
    <div class="flex flex-1 pt-16 bg-background">
      <div id="sidebar-placeholder"></div>
      <main class="flex flex-1 flex-col py-8 px-4 sm:px-6 lg:px-8" id="main-content">
        <div class="flex flex-col w-full max-w-6xl mx-auto flex-1">
          <div id="breadcrumb-container" class="mb-4"></div>
          <header class="flex flex-wrap gap-4 justify-between items-center mb-6 pb-4 border-b border-outline-variant">
            <div>
              <h1 class="text-on-background text-2xl sm:text-3xl font-bold leading-tight tracking-tight">請求書詳細</h1>
              <p class="text-sm text-on-surface-variant mt-2">契約プランごとの請求内容と明細、振込先を確認できます。 </p>
            </div>
            <div class="flex gap-2 items-center"><span id="invoice-status-badge"></span><button
                class="button-secondary inline-flex items-center px-3 py-1 text-sm font-semibold rounded-md"
                id="printInvoiceBtn"><span class="material-icons text-base mr-1 align-middle">print</span>印刷
              </button><button
                class="button-primary inline-flex items-center px-3 py-1 text-sm font-semibold rounded-md"
                id="downloadPdfBtn"><span class="material-icons text-base mr-1 align-middle">download</span>帳票ダウンロード
              </button></div>
          </header>
          <div id="invoice-detail-container" class="relative">
            <div id="invoice-detail-loading-overlay" class="message-overlay hidden">
              <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
            </div>
            <div id="invoice-detail-message-overlay" class="message-overlay hidden">
              <p class="text-on-surface-variant text-lg"></p>
            </div>

            <!-- NOTE: Old Billing Details and Bank Info sections removed and replaced by Invoice Sheet layout below
              -->
            <!-- Invoice Sheet Section (1st Page) -->
            <div id="invoice-sheet-container">
              <div class="invoice-sheet page-1" id="invoice-page-1">
                <!-- ヘッダー -->
                <table class="header-info-table">
                  <tr>
                    <th>発 行 日 :</th>
                    <td id="sheet-issue-date">yyyy/mm/dd</td>
                  </tr>
                  <tr>
                    <th>請求書番号 :</th>
                    <td><span style="font-size: 8pt;" id="sheet-invoice-number">西暦下2ｹﾀ-ﾕｰｻﾞｰID5ｹﾀ+連番3ｹﾀ</span>
                    </td>
                  </tr>
                </table>
                <h1 class="main-title">御 請 求 書</h1>
                <!-- 宛先・差出人 -->
                <div class="top-section">
                  <div class="recipient-area">
                    <table class="recipient-table">
                      <tr>
                        <td class="recipient-name"><span style="font-size: 14pt;" id="sheet-corporate-name"></span></td>
                        <td class="recipient-suffix">御中</td>
                      </tr>
                      <tr>
                        <td class="recipient-name"><span style="font-size: 14pt;" id="sheet-contact-person"></span></td>
                        <td class="recipient-suffix">様</td>
                      </tr>
                    </table>
                    <div class="greeting-text">平素より格別のお引き立てを賜り、誠にありがとうございます。<br>下記の通りご請求申し上げます。 </div>
                  </div>
                  <div class="sender-area"><img src="assets/rogo.png" alt="Abroad Outsourcing" class="logo-img">
                    <div style="font-weight: bold; margin-bottom: 2px;">SPEED AD運営会社</div>
                    <div style="font-weight: bold; font-size: 10pt; margin-bottom: 4px;">アブロードアウトソーシング株式会社</div>
                    <div>東京都千代田区岩本町2-11-9 IT2ビル 8階</div>
                    <div>TEL : 03-5835-0250</div>
                    <div>登録番号 : T9011701016647</div><img src="assets/hanko.png" alt="社印" class="hanko-img">
                  </div>
                </div>
                <!-- 金額・口座 -->
                <div class="summary-container">
                  <div class="summary-left">
                    <table class="summary-table">
                      <tr>
                        <th class="bg-header">件名</th>
                        <td class="text-right" id="sheet-billing-period">SPEED AD利用料</td>
                      </tr>
                      <tr>
                        <th class="bg-header">小計(課税対象)</th>
                        <td class="text-right" id="sheet-subtotal-taxable">●● 円</td>
                      </tr>
                      <tr>
                        <th class="bg-header">消費税等</th>
                        <td class="text-right" id="sheet-tax-amount">●● 円</td>
                      </tr>
                      <tr>
                        <th class="bg-header">小計(非課税)</th>
                        <td class="text-right" id="sheet-subtotal-non-taxable">- 円</td>
                      </tr>
                      <tr class="total-amount-row">
                        <th class="bg-header">合計ご請求金額</th>
                        <td class="text-right"><span class="total-amount" id="sheet-total-amount">●●</span><span
                            style="font-size: 9pt;">(税込)</span></td>
                      </tr>
                    </table>
                  </div>
                  <div class="summary-right">
                    <table class="bank-table">
                      <tr>
                        <th>金融機関名</th>
                        <td id="sheet-bank-name">三井住友銀行 (0009)</td>
                      </tr>
                      <tr>
                        <th>支 店 名</th>
                        <td id="sheet-branch-name">小岩支店 (643)</td>
                      </tr>
                      <tr>
                        <th>口 座 種 類</th>
                        <td id="sheet-account-type">普通</td>
                      </tr>
                      <tr>
                        <th>口 座 番 号</th>
                        <td id="sheet-account-number">7128447</td>
                      </tr>
                      <tr>
                        <th>口 座 名 義</th>
                        <td style="font-size: 7pt;" id="sheet-account-holder">アブロードアウトソーシング株式会社</td>
                      </tr>
                      <tr>
                        <th style="font-size: 7.5pt;">お 支 払 期 日</th>
                        <td id="sheet-due-date"></td>
                      </tr>
                    </table>
                  </div>
                </div>
                <div class="notes-area">
                  <div style="width: 56%; text-align: right;">※お振込手数料は御社でご負担頂けますようお願い申し上げます。</div>
                  <div style="width: 42%; text-align: right;">※お支払期日が休日の場合、前営業日までにお支払いください。</div>
                </div>
                <div style="font-size: 10pt; font-weight: bold; margin-bottom: 2px;">ご請求明細</div>
                <table class="details-table" id="sheet-details-table-1">
                  <thead>
                    <tr class="bg-header">
                      <th class="col-no">No.</th>
                      <th class="col-item1">品 名 １</th>
                      <th class="col-item2">品 名 ２</th>
                      <th class="col-qty">数 量</th>
                      <th class="col-price">単 価</th>
                      <th class="col-amount">金 額</th>
                    </tr>
                  </thead>
                  <tbody id="sheet-details-tbody-1">
                    <!-- JS fills this -->
                  </tbody>
                </table>
                <div class="page-number" id="page-number-1">1/1</div>
              </div>
            </div>

          </div>
        </div>
      </main>
    </div>
    <div id="footer-placeholder"></div>
  </div>
  <script type="module" src="src/main.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</body>

</html>
# SpeedAd UI/UX 追加指示書
# 名刺データ化設定 & お礼メール設定 ページの改善提案

pages:
  - name: "名刺データ化設定ページ"
    id: "bizcardSettings.html"
    description: "アンケートに紐づく名刺データ化の詳細設定と依頼を行うページ。"
    sections:
      - title: "ページヘッダーとアンケートコンテキスト"
        instructions:
          - "[完了] ページタイトルを「アンケート『[アンケート名]』の名刺データ化設定」に変更し、現在設定中のアンケート名を明確に表示する。"
          - "[完了] ページ上部に、現在のアンケートの主要情報（アンケート名、ID、会期）を読み取り専用で簡潔に表示する。"
            layout_example: |
              アンケート名: 【東京】機械要素技術展2025 (ID: sv_20250715_001)
              会期: 2025/07/15 - 2025/07/17
      - title: "主要設定エリアの構造化と視覚的改善"
        instructions:
          - "[完了] 「名刺データ化」機能の有効/無効を、プルダウンから**トグルスイッチ (ON/OFF)** に変更する。"
            details:
              - "[完了] トグルが「無効（OFF）」の場合、その下の「データ化項目プラン」「データ化スピードプラン」「名刺データ化依頼枚数」「クーポンコード」入力フィールドを**グレイアウトし、かつ非表示**にする。不要な要素を隠すことで、UIの複雑さを軽減する。"
          - "[完了] 「データ化項目プラン」と「データ化スピードプラン」の選択を、単なるプルダウンではなく、**カード形式の選択肢（または視覚的に強化されたラジオボタン）** で表示する。"
            details:
              - "[完了] 各カードには、プランの名称に加え、**そのプランで提供される具体的な内容やメリット**を簡潔に記載する。"
              - "[完了] 選択されたカードは、ボーダー色や背景色を変化させ、明確にハイライト表示する。"
          - "[完了] 「名刺データ化依頼枚数」は数値入力フィールドとし、入力欄の右端に単位「枚」を明示する。"
          - "[未完了] 「クーポンコード」入力フィールドの横に**「適用」ボタン**を配置し、入力後すぐに有効性を確認できるようにする。"
            details:
              - "[未完了] クーポン適用成功時には、「クーポン『[クーポンコード]』が適用されました（-¥XXXX）」のような**明示的なトースト通知**を表示する。"
              - "[未完了] 適用失敗時には、具体的なエラーメッセージ（例: 「クーポンコードが無効です」「有効期限切れです」）をエラー表示として表示する。"
      - title: "リアルタイム見積もりと完了予定日の明確化"
        instructions:
          - "[完了] ページ右側（または下部）に、「**名刺データ化費用見積もり**」と「**データ化完了予定日**」のサマリーエリアを常時表示する。"
          - "[完了] ユーザーがプラン、枚数、クーポンの設定を変更するたびに、これらの値が**リアルタイムで更新**されるように実装する。"
          - "[完了] 請求見込み金額は、`data_definitions.md`の`estimatedBillingAmount`に基づき、通貨単位「¥」を付記して表示する。"
      - title: "保存・確定操作とフィードバック"
        instructions:
          - "[完了] 「設定内容の保存・依頼確定機能」のボタンテキストを「**設定を保存して依頼を確定する**」と明確に表示し、プライマリボタンのスタイルを適用する。"
          - "[未完了] このボタンは、全ての必須項目が入力され、バリデーションが成功するまで**無効化（グレイアウト）** する。"
          - "[完了] ボタンクリック時（データ送信開始時）には、即座にボタンを**無効化**し、「**保存中...**」などのローディング表示に切り替える。これは要件定義書3.5.1の**冪等性制御適用**に伴うUI挙動である。"
          - "[未完了] 処理完了後、成功トースト通知（例: 「名刺データ化設定を保存し、依頼を確定しました！」）を表示し、適切な画面（例: アンケート詳細モーダルまたはアンケート一覧）に戻るように遷移を検討する。"
      - title: "その他"
        instructions:
          - "[未完了] メモ欄は独立したセクションとし、必要に応じて展開・折りたたみ可能にすることで、主要な設定項目に集中できるようにする。"
          - "[未完了] 全てのフォーム入力において、`design_guideline.md`に沿った「Raised Label」形式のエラー表示と、リアルタイムおよび送信時のバリデーションを徹底する。"

  - name: "お礼メール設定ページ"
    id: "thankYouEmailSettings.html"
    description: "アンケート回答者へのお礼メールの送信方法と内容を設定するページ。"
    sections:
      - title: "ページヘッダーとアンケートコンテキスト"
        instructions:
          - "ページタイトルを「アンケート『[アンケート名]』のお礼メール設定」に変更し、現在設定中のアンケート名を明確に表示する。"
          - "アンケート名、ID、会期など、設定中のアンケートの主要情報を読み取り専用でページ上部に簡潔に表示する。"
      - title: "送信要否設定と関連項目の動的な制御"
        instructions:
          - "「お礼メール」送信要否を、プルダウンから**トグルスイッチ (ON/OFF)** に変更する。"
            details:
              - "トグルが「無効（OFF）」の場合、その下の「メールテンプレート選択」「メール件名・本文」「送信対象者リスト」「お礼メール送信実行ボタン」など、関連する全ての入力フィールドとセクションを**グレイアウトし、かつ非表示**にする。"
      - title: "送信方法の明確化と条件表示"
        instructions:
          - "トグルが「有効（ON）」の場合に、「自動送信」または「手動送信」を**ラジオボタン**で選択できるようにする。"
          - "各ラジオボタンの横に、その送信方法が「名刺データ化完了後、自動的に送信されます。」「名刺データ化完了後、この画面から手動で送信実行できます。」のような**説明文を付記**し、ユーザーが違いを理解できるようにする。"
      - title: "メールコンテンツ編集の強化"
        instructions:
          - "「メールテンプレート選択」プルダウンの下に、選択されたテンプレートの**プレビューエリア**を設ける。テンプレートを切り替えるたびにプレビュー内容が更新されるようにする。"
          - "「メール件名」と「メール本文」の入力フィールドの下、または入力フィールドにフォーカスがある際に、**「変数挿入」ボタン**を表示する。"
            details:
              - "ボタンクリック時に、`{会社名}`、`{氏名}`など、埋め込み可能な変数のリストを表示し、クリックでカーソル位置に挿入できるようにする。"
          - "メール本文入力フィールドの下に、変数が展開された場合の**リアルタイムプレビュー**を表示し、ユーザーが実際のメール内容を視覚的に確認できるようにする。"
      - title: "送信対象者リストと送信実行の明確な誘導"
        instructions:
          - "「送信対象者リスト」セクションに、送信可能な回答者の総数（例: 「送信対象者: **X件**」）を明確に表示する。"
          - "条件（会期終了、名刺データ化完了）が未達成の場合は、「**会期終了後、名刺データ化が完了すると対象者が表示されます。**」のようなメッセージを表示し、ユーザーに次のステップを促す。"
          - "「お礼メール送信実行」ボタンの有効化条件を明確にする。"
            conditions:
              - "「お礼メール」が「手動送信」に設定されていること。"
              - "アンケートの「会期」が終了していること。"
              - "名刺データ化が完了していること（`bizcardCompletionCount` > 0、またはアンケートステータスが`アップ完了`）。"
              - "送信対象者が1件以上いること。"
          - "上記の条件が全て満たされた場合のみ、ボタンを有効化する。それ以外は**無効化（グレイアウト）** する。"
          - "有効化されたボタンテキストは「**お礼メールを送信する**」とし、プライマリボタンのスタイルを適用する。"
          - "クリック時には、`UI文言・メッセージ定義書`に定義された確認ダイアログ（例: 「本当にXX件のお礼メールを送信しますか？」）を表示する。"
          - "送信処理中はボタンを**無効化**し、「**送信中...**」などのローディング表示に切り替える。これは要件定義書3.5.1の**冪等性制御適用**に伴うUI挙動である。"
          - "送信完了後、成功トースト通知（例: 「お礼メールの送信を開始しました！」）を表示する。"
          - "ページ内で「**送信ステータス: 送信中 / 送信完了 / 送信失敗**」のように、メールの進捗状況を表示するエリアを設ける。"
      - title: "設定保存操作"
        instructions:
          - "「設定内容の保存機能」のボタンテキストを「**設定を保存する**」と表示する。"
          - "このボタンクリック時も、要件定義書3.5.1の**冪等性制御適用**に伴うUI挙動（ボタンの無効化とローディング表示）を適切に行う。"

  - name: "冪等性制御 (Idempotency Control) のUI反映（共通指示）"
    description: "要件定義書3.5.1に基づき、ユーザーがデータ送信操作を行う際のUI挙動を定義する。"
    instructions:
      - "データ送信を伴う全てのボタン（「作成する」「保存する」「更新する」「送信する」など）に対して、以下のUI挙動を適用する。"
        details:
          - "ボタンクリック直後、即座にボタンを**無効化（disabled）** する。"
          - "ボタンのラベルを「保存中...」「送信中...」など、**処理中であることを示すテキスト**に変更するか、ボタン内に**ローディングスピナー**を表示する。"
          - "サーバーからのレスポンスがあるまで、この状態を維持する。
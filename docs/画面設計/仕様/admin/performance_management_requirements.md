---
owner: product
status: draft
last_reviewed: 2026-02-18
---

# 実績管理画面（Performance Management） 要件定義書

## 1. 概要
管理者（Admin）がオペレーター（作業員）の実績を「品質（Quality）」「生産性（Productivity）」「コスト（Cost）」の観点で管理・評価するための専用画面。
**「高い貢献度を持つ人材（ハイパフォーマー）の特定」** および **「パフォーマンスの改善や適切なフォローアップが必要な対象（ローパフォーマー）の早期発見」** を明確に可視化し、適切な報酬支払いと教育的指導、効率的な組織配置を行うことを目的とする。

## 2. 画面基本情報
- **パス:** `03_admin/performance-management.html`
- **対象ユーザー:** システム管理者（Admin権限を持つユーザー）
- **前提:** ログイン済みであること。

## 3. データ定義とKPI計算ロジック

### 3.1. 共通ルール
- **期間集計:** ユーザーが指定した「開始日 00:00:00」から「終了日 23:59:59」までのデータを対象とする。
- **データ更新頻度:**
    - **当日データ:** **準リアルタイム（最大5分程度の遅延を許容）。**
        - ※システム全体のレスポンス維持を優先し、完全なリアルタイムではなくキャッシュ等の利用を推奨する。
    - **過去データ:** パフォーマンス確保のため、**日次集計テーブル（`daily_operator_summary` 等）の利用を必須**とする。
- **数値型制約（Float禁止令）:**
    - 金銭（推定報酬額、修正コスト等）や率（エラー率、納期遵守率等）の計算・保持には、必ず**Decimal型（固定小数点数）**を採用すること。
    - 計算誤差による事故（1円のズレ等）を防ぐため、これらの用途での**Float型（浮動小数点数）の使用は厳禁**とする。
- **報酬額の確定と単価変更ルール:**
    - **月次確定:** 確定（締め）処理が行われた月の報酬データは、その時点の数値を固定（スナップショット保存）し、以降の設定変更の影響を受けない。
    - **当月の単価変更:** 未確定期間（当月）において設定画面で単価が変更された場合、**その月の全データに対して最新の単価が適用され再計算される**（日割り計算等の複雑なロジックは実装しない）。
- **Null/Zero Handling:** 分母0やデータなし時は `-` または `0` を表示。

### 3.2. 指標定義一覧

| 項目名 | 英語名 | 計算式 / 定義 | 単位 | データ型 | 端数処理 | 0除算/Null時 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **入力完了数** | Total Processed | 期間内の完了・承認済みタスク総数（エラー含む） | 枚 | Integer | なし | 0 |
| **エラー件数** | Error Count | 期間内に**管理者（またはチェッカー権限）**によって「否認」または「修正」されたタスク数。<br>※オペレーター自身が完了前に自己修正したものは含まない。 | 枚 | Integer | なし | 0 |
| **有効作業数** | Valid Processed | `入力完了数` - `エラー件数` | 枚 | Integer | なし | 0 |
| **エラー率** | Error Rate | `(エラー件数 ÷ 入力完了数) × 100` | % | Float | 小数点第2位四捨五入 | 0.00% |
| **作業時間** | Work Time | 各タスクの実働時間の総和 | 時間 | String | `HH:mm:ss` | 00:00:00 |
| **平均処理時間** | Avg Time | `作業時間(秒) ÷ 入力完了数` | 秒/枚 | Float | 小数点第1位四捨五入 | - |
| **推定報酬額** | Est. Payment | `有効作業数 × 単価(設定値)`<br>※確定済みの期間は固定値を参照 | 円 | Integer | 切り捨て | 0 |
| **稼働人数** | Active Users | 期間内に1件以上の入力完了があるユーザー数 | 人 | Integer | なし | 0 |
| **登録人数** | Total Users | グループに所属している全ユーザー数 | 人 | Integer | なし | 0 |
| **最大処理能力** | Max Capacity | `(平均処理数[枚/日] × 稼働人数)`<br>※平均処理数は「期間内で稼働実績がある日」のみを母数とする | 枚/日 | Integer | 切り捨て | - |
| **品質レベル** | Quality Level | グループ全体の平均エラー率、および標準偏差（ばらつき）。<br>※当日データは標準偏差非表示（ハイフン）。 | - | String | - | - |
| **コスパ** | Cost Performance | **CPY (Cards Per Yen)**<br>`有効作業数 ÷ (推定報酬額 + 修正コスト)`<br>※`修正コスト = エラー件数(管理者修正分) × 修正単価(設定値)` | 枚/円 | Float | 小数点第2位四捨五入 | - |
| **納期遵守率** | On-time Rate | `(納期内完了数 ÷ 総完了数) × 100` | % | Float | 小数点第1位 | - |

## 4. 画面UI詳細仕様

### 4.1. ヘッダーエリア（サマリー & 指標・パラメータ設定）

#### ①-1 指標・パラメータ設定モーダル
管理者が評価基準や計算用単価を動的に変更できる機能を実装する。
- **設定項目:** 目標KPI（枚数、エラー率、時間）、単価、修正コスト単価、算出対象期間。
- **反映:** 未確定期間の計算に即座に反映。保存時に変更履歴を残す。

#### ①-2 今月の支払い確定額（全体サマリー）
全グループ総合の数値を表示。前月比 % 付き。着地見込み（簡易予測）を併記する。

#### ①-3 絞り込み機能（フィルタ） & CSV出力
- **フィルタ (アコーディオン):** デフォルトで展開。タブごとに最適なフィルタ項目を表示。右下に「条件をリセット」ボタンを配置。
    - **共通:** キーワード検索窓は左上に配置し、2カラム分の幅（50%幅）を使用する。
    - **個人タブ:** キーワード、対象期間、稼働状態、展示会・案件、グループ、達成状況、品質レベル（正確さ）。
    - **グループタブ:** キーワード（グループ名）、対象期間、パフォーマンス状態（優秀層/要改善）、グループ規模、コスパ（CPY）、納期遵守率。
- **CSVダウンロードボタン:**
    - **機能:** 現在表示されているフィルタ条件で絞り込まれたデータをCSV形式で出力する。
    - **出力項目:** 画面上の表示項目に加え、**システムID、詳細タイムスタンプ、各タスクの内訳データ（経理・詳細分析用）**を含めることを必須とする。
    - **フォーマット:** Excelで文字化けしないようBOM付きとする。

### 4.2. メインエリア（一覧テーブル）

#### 【タブA：個人単位】
個々のパフォーマンスを可視化し、貢献度と改善課題を明確にする。

**一覧テーブル項目:**
| 項目 | 内容・計算式 | UI表現・備考 |
| :--- | :--- | :--- |
| **オペレーター名/所属** | 氏名 + グループ名 | アイコン表示（ユーザー名から生成した動的なGoogleライクカラー） |
| **入力完了数** | 入力総数 | 中央揃え |
| **エラー件数** | 管理者修正分 | 中央揃え |
| **有効作業数** | `入力完了数 - エラー件数` | **支払い対象（最重要）**、中央揃え、太字・青色強調 |
| **作業時間/平均** | `Total ◯h / Avg ◯s` | 併記する、中央揃え |
| **推定報酬額** | `有効作業数 × 設定単価` | 確定済みデータは固定、中央揃え |
| **正確さ** | `有効作業数 / 入力完了数` | **(%)表示**、中央揃え、低品質(95%未満)は赤字強調 |
| **達成状況** | 指標設定に対するクリア状況 | **色分け/マーク表示**<br>・達成: <span style="color:blue">●</span> 青色強調<br>・未達: <span style="color:red">▲</span> 赤色強調、中央揃え |

#### 【タブB：グループ単位】
「組織単位での能力/パワー」「コスパ」を確認する。

**一覧テーブル項目:**
| 項目 | 内容・計算式 | UI表現・備考 |
| :--- | :--- | :--- |
| **グループ名** | 会社名 | 左揃え |
| **稼働 / 登録人数** | `稼働人数 / 登録人数` | 動員力、中央揃え |
| **最大処理能力** | `平均処理数 × 稼働人数` | キャパシティ、中央揃え |
| **品質レベル** | 1枚平均速度 / 品質のばらつき | 当日分はばらつき非表示、中央揃え |
| **コスパ** | CPY (Cards Per Yen) | 修正コスト(設定値)を加味して算出、中央揃え |
| **納期遵守率** | `納期内完了数 ÷ 総数` | 指標として表示、中央揃え |

**ページネーション:**
- 中央配置。
- 表示件数切り替え（25, 50, 100）機能を持つ。

### 4.3. 詳細モーダル仕様（Drill Down）

行（個人/グループ）をクリックするとモーダルで詳細を表示。各モーダルからCSVダウンロードが可能。

#### 【個人詳細モーダル】
1.  **詳細数値 & 比較:**
    - テーブル項目の詳細表示に加え、**前月平均との比較（前月比%）**を表示。
2.  **複合グラフ (Combo Chart):** 処理枚数(棒) と エラー率(折れ線)。
3. **レーダーチャート (Radar Chart):**
    - **目的:** 苦手分野の可視化・教育的フォローアップポイントの特定。
    - **軸:** `氏名`, `会社名`, `住所`, `電話番号`, `メールアドレス`
4. **追加メトリクス:**
    - **修正発生コスト:** エラー数 × 修正単価で算出。
    - **最終稼働日:** 履歴データから最新の日付を特定。
    - **全体平均比較:** 平均処理時間の全体平均との差分（s単位）を表示。

#### 【グループ詳細モーダル】
1.  **グループサマリー & 比較:**
    - 最大能力、総コスト、平均品質、コスパに加え、**合計報酬額**を表示。
2.  **合計処理数の推移グラフ (Line Chart):**
    - グループ全体の1日ごとの処理枚数を積み上げた折れ線グラフ。
3.  **所属オペレーター一覧テーブル:**
    - グループ内オペレーターの実績リスト。
    - **項目:** 氏名（左揃え）、完了数、Avg Time、正確さ（98%未満は赤字）、報酬額。
    - **表現:** 氏名以外の数値項目はすべて中央揃えとする。
    - **初期ソート:** エラー率の高い順（課題のある対象を優先表示）。
4.  **散布図 (Scatter Plot):**
    - **プロット:** 所属しているオペレーター全員
    - **X軸:** **平均処理時間（秒/枚）**
        - **※左に行くほど数値が小さく（＝速い）なるように配置する。**
    - **Y軸:** 正確さ（上に行くほど正確）
    - **分析:** 「要改善 (Critical)」ラベルを表示。

## 5. 将来の拡張要件 (Future Scope - Phase 2以降)
現時点では実装対象外とするが、将来的に検討すべき事項。
- **柔軟な単価設定 (Advanced Pricing):**
    - **案件別単価:** 展示会（案件）ごとの難易度に応じた個別単価設定機能。
    - **期間指定単価:** 「◯月◯日～◯月◯日は単価X円」といった期間ベースの単価適用機能。
- **アラート通知機能:** エラー率が閾値を超えた際、管理者にプッシュ通知またはメールを送信。
- **直接アクション機能:** 詳細モーダルからオペレーターへ直接「警告メール」や「フィードバック」を送信するボタン。
- **ダッシュボードへのウィジェット追加:** 本画面の主要指標を管理者トップ画面に表示。

## 6. セキュリティと権限 (Security & Access Control)

### 6.1. アクセス制御
- **閲覧可能ロール:** システム管理者 (Admin) のみ。
- **アクセス禁止:** オペレーター (Operator) アカウントおよび、権限を持たない一般ユーザーは本ページへアクセスできないこと（403 Forbidden またはダッシュボードへのリダイレクト）。

### 6.2. 個人情報保護とログ
- **個人情報マスク:** 管理者専用画面であり、業務効率を優先するため、連絡先等のマスク処理は**不要**とする。
- **監査ログ (Audit Log):** 以下の操作はセキュリティ監査ログとして記録すること。
    - 実績データのCSVダウンロード（ダウンロード日時、実行ユーザーID、フィルタ条件）
    - 指標・パラメータ設定の変更（変更日時、変更前後の値、実行ユーザーID）

## 7. システム制約と環境 (System Constraints)

### 7.1. 推奨環境
- **デバイス:** PC（デスクトップ/ラップトップ）推奨。
- **解像度:** 横幅 1280px 以上推奨。
    - テーブルの列数が多く、グラフを表示するため、モバイル端末（スマートフォン）での閲覧はレイアウト崩れを許容し、非推奨とする。

### 7.2. データ運用・パフォーマンス (Data Strategy)
- **過去データ:** 確定後の報酬データは固定（スナップショット保存）。
- **集計パフォーマンス:** **日次集計テーブルの作成・利用を必須**とする。対象データが数万件を超える場合のリアルタイム集計は禁止する。
- **設定値の永続化:** 指標・パラメータ設定値はDBに保存。

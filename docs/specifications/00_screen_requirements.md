# 画面要件定義書：SpeedAd - アンケート管理ダッシュボード

## 1. 概要

本ドキュメントは、SpeedAdサービスのアンケート管理ダッシュボード画面に関する要件を定義する。
この画面は、ユーザーがアンケートのライフサイクル全体を管理するための中心的なインターフェースとして機能する。

## 2. 画面目的

- ユーザーが自身のアカウントに関連する全てのアンケートを一覧で把握できること。
- アンケートのステータス（会期前、会期中、終了後など）を直感的に理解できること。
- 新しいアンケートを容易に作成できること。
- 既存のアンケートの詳細確認、編集、および関連データ（QRコード、回答データ）へのアクセスが迅速に行えること。
- ユーザー自身のプロファイル情報や所属グループの管理ができること。

## 3. レイアウトとレスポンシブ対応

### 3.1. 基本レイアウト

- **ヘッダー**: 画面上部に固定。ブランドロゴ、ユーザー情報、グローバルナビゲーション（テーマ切替など）を配置する。
- **サイドバー**: 画面左側に配置。主要機能へのナビゲーションリンク、グループ管理機能を提供する。
- **メインコンテンツ**: 画面中央の主要エリア。アンケート一覧と関連する操作パネルを配置する。
- **フッター**: 画面下部に配置。補足的なリンク（利用規約、プライバシーポリシー等）やコピーライト情報を表示する。

### 3.2. レスポンシブ挙動

- **デスクトップ (XL, >1280px)**: サイドバーはデフォルトで折りたたまれており（アイコンのみ表示）、ホバーすることで展開される。
- **タブレット (LG, 1024px - 1279px)**: サイドバーは常に展開された状態で表示される。
- **モバイル (<1023px)**: サイドバーはデフォルトで非表示。ヘッダーのハンバーガーメニューをタップすることで、画面左からオーバーレイとして表示される。

## 4. 機能要件

### 4.1. ヘッダー

- **4.1.1. ブランドロゴ**: クリックするとダッシュボードのトップ（本画面）に遷移する。
- **4.1.2. ユーザー表示**: ログイン中のユーザーのメールアドレスを表示する。クリックするとアカウント情報モーダルが開く。
- **4.1.3. テーマ切替**: サイドバーからライトモードとダークモードを切り替える。状態はローカルストレージに保存され、次回アクセス時も維持される。
- **4.1.4. モバイルメニューボタン**: モバイル表示時のみ表示。クリックでサイドバーを開閉する。

### 4.2. サイドバー

- **4.2.1. プロファイル表示**: ユーザーアイコン、メールアドレス、現在選択中のグループ名を表示する。
    - UXノート: ユーザーの現在のコンテキストを常に明確に表示。
- **4.2.2. グループ管理**:
    - **グループ選択ドロップダウン**: 所属するグループの一覧を表示し、選択したグループに即時切り替え。
        - UXノート: 「切替」ボタンを廃止し、選択と同時に切り替えを行うことで操作ステップを削減。
    - **グループ新規作成ボタン**: クリックでグループ作成モーダルが開く。
    - UXノート: グループ関連機能を一箇所に集約し、効率的な管理を可能にする。
- **4.2.3. ナビゲーション**:
    - **アンケート管理**:
        - **アンケート一覧**: 本画面へのリンク。
            - UXノート: 主要な機能へのアクセス。
        - **アンケート新規作成**: 新規アンケート作成モーダルを開く。
            - UXノート: 主要な機能へのアクセス。
    - **アカウント・設定**:
        - **アカウント情報**: アカウント情報モーダルを開く。
            - UXノート: ユーザー固有の設定へのアクセス。
        - **ログアウト**: ユーザーをログアウトさせる。
            - UXノート: セキュリティとセッション管理。
    - **テーマ切替**: サイドバー下部に配置され、ライトモードとダークモードを切り替える。
        - UXノート: 主要ナビゲーションとは異なる性質の機能のため、独立した配置。
    - UXノート: 主要機能とユーティリティ機能を分離し、情報構造を明確にする.

### 4.3. メインコンテンツ（アンケート一覧）

- **4.3.1. アンケート新規作成**
    - **シナリオ**: ユーザーは新しい展示会に向けて、新しいアンケートの作成を開始したい。
    - **操作**: 「アンケート新規作成」ボタンをクリックする。
    - **期待される結果**: 新規アンケート作成モーダル(`newSurveyModal`)が開く。

- **4.3.2. 検索・フィルタリング**
    - **シナリオ**:
        - **(営業担当者)** 特定の展示会（例: "ABC展示会"）の来場者アンケートの中から、特に「緊急度が高い」と回答した人を素早く見つけ出し、フォローアップリストを作成したい。
        - **(マーケティング担当者)** 今月実施した全てのアンケートで、どれくらいの回答が集まっているかを横断的に確認したい。
    - **操作**:
        - **キーワード検索**: 検索ボックスにキーワード（例: "ABC展示会"）を入力する。
        - **ステータスフィルター**: ドロップダウンから「会期中」を選択する。
        - **期間フィルター**: カレンダーUIで当月の開始日と終了日を選択する。
    - **期待される結果**:
        - 入力・選択のたびに、アンケート一覧テーブルが即座に更新され、条件に一致するアンケートのみが表示される。
        - 複数のフィルター条件はANDで結合される。
    - **データソース**:
        | フィルター | 対象データ (`surveys.json` のキー) |
        | :--- | :--- |
        | キーワード検索 | `name`, `displayTitle` |
        | ステータスフィルター | `status` ( `periodStart`, `periodEnd` から動的算出) |
        | 期間フィルター | `periodStart`, `periodEnd` |

- **4.3.3. アンケートテーブル**
    - **シナリオ**: ユーザーは、管理しているアンケートの一覧を俯瞰し、それぞれのステータスや回答数を一目で比較したい。
    - **期待される結果**: テーブルには、各アンケートの主要な情報が表示され、列名をクリックすることでソートが可能。
    - **データソース**:
        | 表示項目 | データソース | 備考 |
        | :--- | :--- | :--- |
        | アンケートID | `surveys.json` -> `surveyId` | |
        | アンケート名 | `surveys.json` -> `name` | |
        | ステータス | `surveys.json` -> `periodStart`, `periodEnd` | 現在日時と比較して動的に「会期前」「会期中」「終了後」を算出 |
        | 回答数 | `survey-answers.json` | `surveyId` に紐づく回答数をカウント |
        | 展示会会期 | `surveys.json` -> `periodStart`, `periodEnd` | `YYYY/MM/DD - YYYY/MM/DD` の形式で表示 |
    - **アクション**:
        - **編集**: アンケート編集画面へ遷移する。（現在は未実装である旨のメッセージを表示）
        - **QRコード**: アンケート回答用URLのQRコードをモーダルで表示する。
        - **アンケートの複製**: 選択したアンケートの情報を引き継ぎ、新しいアンケートを作成する。
        - **データダウンロード**: 回答データや名刺画像のダウンロードオプションをモーダルで表示する。
    - **行クリック**: テーブルの行自体をクリックすると、アンケート詳細モーダルが開く。

- **4.3.4. ページネーション**
    - **シナリオ**: ユーザーは100件以上のアンケートを管理しており、一度にすべてのデータをロードすることなく、快適にリストを閲覧したい。
    - **操作**: ページ番号をクリックするか、「前へ」「次へ」ボタンでページを移動する。1ページあたりの表示件数をドロップダウンで変更する。
    - **期待される結果**: 指定された件数とページ番号に応じて、テーブルの内容がスムーズに切り替わる。

### 4.4. モーダルウィンドウ

各モーダルは、背景をスクリム（半透明の黒）で覆い、コンテンツを中央に表示する。Escキーで閉じることができる。

- **4.4.1. 新規アンケート作成モーダル**
    - **シナリオ**: ユーザーはダッシュボードから離れることなく、素早く新しいアンケートの基本情報（名前、期間など）を設定したい。
    - **期待される結果**: フォームに入力した内容が、アンケート作成ページのURLクエリパラメータとして渡され、作成作業をスムーズに継続できる。

- **4.4.2. アンケート詳細モーダル**
    - **シナリオ**: ユーザーは一覧から特定のアンケートをクリックし、その詳細（特に社内メモや設定プラン）を素早く確認したい。また、会期前であれば、急な変更に対応するためにアンケート名を修正したい。
    - **期待される結果**: アンケートの全情報が読み取り専用で表示される。ステータスが「会期前」の場合のみ、特定のフィールドが編集可能になる。編集不可の項目（自動計算される見込み請求額など）は、その理由がツールチップ等で示される。
    - **データソース**:
        | 表示項目 | データソース | 備考 |
        | :--- | :--- | :--- |
        | アンケート名 | `surveys.json` -> `name` | 会期前のみ編集可 |
        | 表示タイトル | `surveys.json` -> `displayTitle` | 会期前のみ編集可 |
        | メモ | `surveys.json` -> `memo` | 会期前のみ編集可 |
        | プラン | `surveys.json` -> `plan` | 会期前のみ編集可 |
        | 見込み請求額 | `bizcardCalculator.js` | `plan` と `bizcardRequest` から自動計算（編集不可） |
        | データ化完了予定日 | `surveys.json` -> `deadline` | （編集不可） |
        | ダウンロード期限 | `surveys.json` -> `downloadDeadline` | （編集不可） |

- **4.4.3. QRコードモーダル**: アンケートURLとQRコード画像を表示する。URLのコピー機能、QRコード画像のダウンロード機能を持つ。
- **4.4.4. データダウンロードモーダル**: 回答データや名刺画像のダウンロードオプション（期間、ファイル形式など）を選択するフォーム。
- **4.4.5. アカウント情報モーダル**: ユーザー自身の連絡先、請求先情報などを編集するフォーム。
- **4.4.6. グループ管理モーダル**: グループの作成・編集を行うフォーム。メンバーの招待や役割の管理もここで行う。
- **4.4.7. お問い合わせモーダル**: サービス提供者への問い合わせフォーム。

### 4.5. アンケート回答ページ

- **4.5.1. 概要**: アンケートの回答者が実際に質問に答えるための画面。
- **4.5.2. 動的表示**: URLのクエリパラメータで渡されたアンケートIDに基づき、該当するアンケートのタイトル、説明、設問を動的にページ上に生成する。
- **4.5.3. 回答フォーム**: 設問の種別（自由回答、単一選択など）に応じて、適切な入力コントロール（テキストエリア、ラジオボタンなど）を表示する。
- **4.5.4. 回答の保存**: 「回答を送信する」ボタンをクリックすると、入力された内容が収集され、ブラウザのローカルストレージに保存される（バックエンド連携は本フェーズの対象外）。
- **4.5.5. 完了表示**: 回答送信後、フォームが非表示になり、「ご回答ありがとうございます」といった完了メッセージが表示される。

## 5. 非機能要件

- **5.1. パフォーマンス**: フィルタリング、ソート、ページネーションの各操作は、1秒以内に画面が応答すること。
- **5.2. スタイル**: デザインガイドライン（`service-top-style.css`）に準拠し、一貫性のあるUIを提供する。
- **5.3. アクセシビリティ**:
    - 主要な操作はキーボードのみで可能であること。
    - `aria-label`などを適切に設定し、スクリーンリーダーによる読み上げに対応すること。
    - `prefers-reduced-motion`を尊重し、アニメーションを無効化するオプションを提供すること。
- **5.4. バリデーション**: 全てのフォーム入力には、リアルタイム（入力時・フォーカスアウト時）および送信時にバリデーションを行い、エラーメッセージを分かりやすく表示すること。
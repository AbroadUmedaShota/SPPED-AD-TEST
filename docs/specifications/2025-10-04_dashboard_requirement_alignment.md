# 2025-10-04 ダッシュボード改善要件整理

## 目的
- 2025-10-04 打ち合わせで合意した改善項目を、現行ダッシュボード実装と突き合わせて整理する。
- 既存画面で対応済みの内容／追加設計が必要な内容を可視化し、実装優先度を決めやすくする。

## 凡例
- `対応済み` : 現行実装で要件を満たしている。
- `要対応` : 実装・スタイル調整・追加仕様の検討が必要。
- `追加検討` : 仕様の詳細詰めが必要、または依存機能の把握待ち。

---

## 1. アンケート一覧
- **ステータスフィルターから「削除済み」「不明」を除外** — 要対応  
  現状: `02_dashboard/src/tableManager.js:38` でユーザー表示用ステータスに `削除済み` / `不明` を返却。フィルターセレクト (`02_dashboard/index.html:66`) からの除外と、バッジ表示の非表示制御が必要。  
  方針: ユーザー画面は業務上利用するステータスのみを表示し、`削除済み` はリストからも除外する。
- **フィルターリセットボタンの視認性調整** — 要対応  
  現状: 強調ボタン風スタイル (`02_dashboard/index.html:98`) で主要CTAより目立つ。  
  方針: テキストボタン相当のスタイルへ変更し、`アンケート新規作成` ボタンが主CTAとして視認できるようにする。
- **「アンケート名」と「表示タイトル」の違いを説明** — 要対応  
  現状: 詳細モーダルの表示 (`02_dashboard/src/surveyDetailsModal.js:194`) や一覧テーブルに説明がなく、新規利用者が区別しづらい。  
  方針: 詳細モーダル内にヘルプアイコン + ポップオーバーを追加し、用途の説明を表示する。
- **会期開始日を過去日・当日に設定できないよう制限** — 要対応  
  現状: 日付ピッカー初期化 (`02_dashboard/src/ui/datepicker.js:18-24`) では最小日付を制御しておらず、ロジックでも当日以前の入力をブロックしていない。  
  方針: `minDate` を翌日以降に設定し、保存時にもバリデーションを追加する。
- **アンケート詳細のステータス文言を管理画面と統一** — 要対応  
  現状: 詳細モーダルのバッジ生成 (`02_dashboard/src/surveyDetailsModal.js:231-246`) に独自ラベルが残っており、管理画面との齟齬が生じる可能性がある。  
  方針: 管理画面用の定義を流用し、共通ヘルパーで表示名を決定する。
- **請求額ラベルの切り替え（見込み⇔確定）** — 対応済み  
  現状: データ完了ステータスを基に `見込み請求額` / `確定請求額` を切り替え (`02_dashboard/src/surveyDetailsModal.js:263-270`) 済み。  
  対応: 追加作業不要。
- **SPEEDレビューをアクションアイコンに追加** — 対応済み  
  現状: 行アクションに `bolt` アイコンボタンを表示し (`02_dashboard/src/tableManager.js:197`)、クリックでレビュー画面に遷移 (`02_dashboard/src/tableManager.js:227`)。  
  対応: 仕様上の注意点のみ記載すれば良い。
- **データダウンロード文言・時間指定** — 要対応  
  現状: モーダルの文言は「名刺データ」のまま (`02_dashboard/modals/downloadOptionsModal.html:18-19`)、時間指定UIは未実装 (`02_dashboard/src/downloadOptionsModal.js` に時間入力なし)。  
  方針: ラジオボタン文言を「名刺入力データ」に変更し、開始/終了時間の入力と既定値「0:00〜24:00」を追加。
- **アンケートURL クリックコピー** — 対応済み  
  現状: URL入力クリックで `copyTextToClipboard` を実行し、トースト通知を表示 (`02_dashboard/src/surveyDetailsModal.js:43-56`)。  
  対応: 動作確認のみ。
- **ページタイトルの二重表示を解消** — 追加検討  
  現状: `<title>` と `<h1>` がともに「アンケート一覧」 (`02_dashboard/index.html:6`,`02_dashboard/index.html:44`)。ヘッダー構造の調整有無はデザイン判断が必要。  
  方針: 情報設計と合わせて整理。

## 2. アンケート作成・編集
- **言語設定をプロフェッショナルプラン限定で表示** — 対応済み  
  現状: プラン判定で言語セクションを `hidden` 制御 (`02_dashboard/src/surveyCreation.js:623-641`)。  
  対応: ドキュメント更新のみ。
- **任意グループに設問を追加できるよう修正** — 対応済み  
  現状: グループ内ボタンが `groupId` を渡し、対象グループに設問を挿入 (`02_dashboard/src/surveyCreation.js:1647-1670`)。  
  対応: 操作説明を明記する。
- **空のグループにも設問追加を許可** — 対応済み  
  現状: 新規グループ生成後も `questions` を初期化し同ボタンで追加可能。UIテンプレート (`02_dashboard/surveyCreation.html:165-205`) にボタンを配置済み。  
  対応: QA確認のみ。
- **目次からジャンプした際にページ上部へ配置** — 要対応  
  現状: アンカーリンクのみ (`02_dashboard/src/ui/surveyRenderer.js:559-595`) でスクロール位置補正なし。  
  方針: `scrollMarginTop` 付与 or 目次遷移時にオフセット調整を行う。
- **目次内にプレビュー・保存ボタンを追加** — 対応済み（表示制御要確認）  
  現状: `outline-action-buttons` にボタンを用意 (`02_dashboard/surveyCreation.html:33-48`)、`updateOutlineActionsState` で活性制御 (`02_dashboard/src/surveyCreation.js:661-666`)。  
  方針: 発火条件とアクセシビリティを仕様に明記。
- **プレビュー表示を実機スマホに近づける／アイコン表記を◯/□へ** — 要対応  
  現状: プレビューは Material Icons (`radio_button_unchecked` / `check_box_outline_blank`) を使用 (`02_dashboard/src/ui/surveyRenderer.js:2106-2121`)。  
  方針: スマホ幅レイアウト・実際の装飾に近いCSSへ改修。
- **QRコード表示機能を追加** — 要対応  
  現状: `QRコード` ボタンは配置済み (`02_dashboard/surveyCreation.html:199`) だがクリック処理未実装 (`02_dashboard/src/surveyCreation.js:653-659` の制御のみ)。  
  方針: 新規モーダル実装とアンケートID発行後の有効化フローを定義。

## 3. 名刺データ化設定
- **必須項目（※説明・請求詳細・データ化詳細）の常時表示** — 要対応  
  現状: ガイドの表示条件が整理されておらず、必要時のみモーダルで補足するUIが残る (`02_dashboard/src/bizcardSettings.js` 全体確認が必要)。  
  方針: ラベルに必須表記を付与し、折りたたみ無しで表示する仕様に更新。
- **料金プランの視覚的区別** — 追加検討  
  現状: プラン別の料金提示がテキストのみで、無料/スタンダードの差異が分かりづらい。  
  方針: カード型の料金比較 or バッジ表示を検討。デザイン決定後に実装。

## 4. お礼メール設定
- **送信設定のデフォルトを手動に統一／オンデマンドのみ自動送信** — 要対応  
  現状: デフォルト値は `manual` (`02_dashboard/src/services/thankYouEmailService.js:36-45`) だが、プラン情報による制御が存在しない。  
  方針: プラン判定ロジックを取得し、オンデマンド以外は自動送信ラジオボタンを無効化する。

## 5. サンクス画面設定
- **連続回答機能の初期状態をオフに変更** — 要対応  
  現状: 既定値は `true` (`02_dashboard/src/thankYouScreenSettings.js:131-144`)。  
  方針: 初期値を `false` にし、仕様書 (`docs/specifications/08_thank_you_screen_settings.md`) も更新する。

## 6. その他横断要件
- **アカウント情報モーダルの「パスワードを変更する」重複を解消** — 要対応  
  現状: モーダル上部/下部に同ボタンが併存 (`02_dashboard/src/accountInfoModal.js` 要確認)。  
  方針: 上部アクションに統一し、導線を1箇所に絞る。
- **サイドメニュー整理** — 要対応  
  現状: ナビに「アンケート新規作成」リンクが残存 (`02_dashboard/common/sidebar.html:36-38`)。  
  方針: `アンケート一覧` に集約し、作成導線は画面内CTAへ。
- **グループ機能の戻り導線／招待挙動の明文化／権限と請求先仕様の再設計** — 追加検討  
  現状: `docs/specifications/group_edit_requirements.md` に現行仕様はあるが、個人ビューや招待フロー、権限に紐づく請求表示の定義が不足。  
  方針: 追加の業務整理が必要。
- **言語切替の全画面適用** — 要対応  
  現状: ページ個別に `initLanguageSwitcher` を実装しているが (`02_dashboard/src/surveyCreation.js:402-420` 他)、共通ヘッダーと各モジュールで挙動が乖離。  
  方針: 共通ストア／イベント駆動で全画面に反映する仕組みを設計する。

---

## 次のアクション例
1. 本メモをベースに関連仕様書（画面要件・機能仕様）へ反映範囲を決定する。
2. 優先度の高い項目（例: ステータス表示、日付バリデーション、連続回答初期値）から設計タスクを起票する。
3. デザイン調整が必要な項目について、デザインチームとモック/ガイドライン更新を行う。

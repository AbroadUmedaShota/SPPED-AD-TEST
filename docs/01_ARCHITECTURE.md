# 01_ARCHITECTURE.md: フロントエンドアーキテクチャ

## 1. はじめに

このドキュメントは、SPEED AD プロジェクトのフロントエンドアーキテクチャについて記述します。

**現在の開発フェーズは、静的JSONデータを活用したUI/UXのプロトタイピング（モック画面開発）です。**
そのため、本ドキュメントはバックエンドとの連携を前提とせず、フロントエンド内部の設計原則、コンポーネント構成、データフローに焦点を当てています。

## 2. 設計原則

本システムの設計は、以下の主要な原則に基づいています。

### 2.1. UIのモジュール化/コンポーネント化

- **目的**: UIの一貫性、再利用性、保守性の向上。
- **アプローチ**:
    - **共通UI要素の分離**: ヘッダー、サイドバー、フッターなどの共通UI要素は、`common/` ディレクトリ内の独立したHTMLファイルとして定義されています。これらはJavaScript (`utils.js` の `loadCommonHtml` 関数) を通じて、**すべての主要なアプリケーションページに**動的に組み込まれます。
    - **コンポーネントベースのUI開発**: モーダル (`modals/` ディレクトリのHTMLファイルと `modalHandler.js`) やテーブル (`tableManager.js`) など、複雑なUI要素も独立したモジュールとして管理されます。これにより、各UI要素が単一の責務を持ち、独立して開発・テスト・保守が可能です。
    - **テンプレートの活用**: HTMLの `<template>` 要素をJavaScriptから利用し、動的にUI要素を生成することで、再利用可能なUIコンポーネントを効率的に構築しています。

### 2.2. 関心の分離とレイヤー化

- **目的**: コードの疎結合化、保守性、拡張性の向上。
- **アプローチ**:
    - **UI層 (`src/ui/`)**: ユーザーインターフェースの描画とユーザーインタラクションに責任を持ちます。（例: `surveyRenderer.js`, `tableManager.js`）。
    - **サービス層 (`src/services/`)**: データ取得、永続化、ビジネスロジックといったデータ操作を抽象化します。UI層から独立しており、データソースの変更がUIに影響を与えにくい設計です。（例: `surveyService.js`, `groupService.js`）。
    - **コントローラー層 (各ページのJS)**: ユーザー操作を起点として、UI層とサービス層を連携させる役割を担います。（例: `indexPage.js`, `surveyCreation.js`）。
    - **ユーティリティ層 (`src/utils.js`)**: アプリケーション全体で利用される共通機能（スクロール制御、トースト通知、クリップボード操作など）をカプセル化し、他のモジュールがこれらを再利用することで、コードの重複を避け、一貫したUI/UXを提供します。
    - **メインアプリケーション層 (`src/main.js`)**: アプリケーションのエントリーポイントとして、各モジュールの初期化と連携を管理します。

### 2.3. ユーザーエクスペリエンスへの配慮

- **目的**: 直感的で使いやすいアプリケーションの提供。
- **アプローチ**:
    - レスポンシブデザイン、直感的なUI、ローディングインジケーター、トースト通知、詳細なページネーション、ソート機能など、ユーザーがスムーズにアプリケーションを利用できるような多くの配慮がなされています。

## 3. データフローと状態管理

- **データソース**: **本モックアップ開発フェーズでは、すべての動的データは `02_dashboard/data/` ディレクトリ内の静的JSONファイルから取得します。** これらはモックAPIとして機能し、バックエンドの存在をシミュレートします。
- **データ取得**: 各サービス層のモジュール (例: `surveyService.js`) が、標準の `fetch` API を用いて対応するJSONファイルを非同期に読み込みます。
- **状態管理**: アプリケーションのグローバルな状態（例: ログインユーザー情報、選択中のテーマ）は、現時点では各モジュールが個別に管理するか、DOMを通じて受け渡しています。複雑な状態管理ライブラリは導入せず、シンプルな構成を維持しています。

## 4. 主要コンポーネント

本システムは、以下の主要なコンポーネントで構成されています。

- **共通UIコンポーネント**: ヘッダー、サイドバー、フッター、モーダル、トースト通知など、アプリケーション全体で再利用されるUI要素。
- **ページ固有UIコンポーネント**: アンケート一覧テーブル、アンケート作成フォームなど、特定のページに特化したUI要素。
- **データサービス**: アンケートデータ、グループデータなど、各エンティティのデータ取得・操作を抽象化するサービス。
- **ユーティリティ**: スクロール制御、クリップボード操作など、アプリケーション全体で利用される汎用的な機能。

## 5. 将来的なアーキテクチャ構想（本フェーズの対象外）

モックアップ開発完了後、バックエンド開発フェーズに移行した際には、以下のアーキテクチャを想定しています。

- **インフラストラクチャ**: AWSをインフラ基盤とし、nginx, PHP/Laravel, MySQL, Redisなどを用いた構成を想定しています。
- **堅牢性と信頼性**: サーバーサイドでの冪等性制御の実装や、詳細なエラーハンドリングにより、システムの安定稼働とデータ整合性の確保を目指します。
- **API連携**: 現在のサービス層 (`src/services/`) が、静的JSONファイルの代わりにRESTful APIと通信するように改修される予定です。

詳細については、[データ構造定義書](architecture/02_data_model.md)を参照してください。

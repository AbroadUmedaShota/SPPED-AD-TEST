## Webアプリ『SPEED AD』ユーザー権限仕様書（更新版）

### 1. 権限の概要
本アプリのアカウントは、「利用者画面アカウント」と「管理者画面アカウント」に大別され、それぞれの画面内での役割に応じて権限が設定されています。

| アカウント種別 | 権限名 | 主な役割 | アクセス可能画面 |
| :--- | :--- | :--- | :--- |
| **利用者画面** | **User** | 一般利用者。自身が作成・招待されたアンケートの管理を行う。 | 利用者画面のみ |
| **管理者画面** | **Operator** | 名刺データの入力スタッフ用。データ入力作業に特化した権限。 | 管理者画面（名刺入力画面のみ） |
| | **OperatorAdmin** | 名刺データ入力スタッフを管理。所属スタッフの成績や報酬を確認できる。 | 管理者画面（名刺入力・実績画面） |
| | **Admin** | 社内スタッフ用。ユーザーサポート、進捗管理、納品データの最終確認を行う。 | 管理者画面（全般） |
| | **MasterAdmin** | 上級管理者。Adminの全機能に加え、管理系アカウント（Operator／OperatorAdmin／Admin）の作成や権限変更を行う。 | 管理者画面（全般） |

---

### 2. 各権限の詳細

#### 2.1. User（一般利用者）
サービスの基本的な機能を利用するアカウントです。
*   **アカウントの作成:** 利用者本人がサービスサイトから新規登録します。
*   **可能な操作:**
    *   アカウントの新規作成、ログイン、ログアウト
    *   アンケートの新規作成、編集、回答結果（CSV）のダウンロード
    *   有料プランの申し込み、名刺画像のアップロード、名刺データ化後データのダウンロード
    *   同一企業・組織の他ユーザーの招待
*   **操作の制限:**
    *   **アカウント情報の変更:** 会期開始後は、請求情報に影響する可能性があるため変更ができません。
    *   **アンケートの変更:** 会期スタートの前日まではアンケート名や会期の修正が可能ですが、会期スタート後は変更できません。
    *   **アンケートの削除:** 運用中・運用後のアンケートは削除できません。

#### 2.2. Operator / OperatorAdmin（入力スタッフ系アカウント）

##### 2.2.1. Operator（入力スタッフ）
名刺データ化作業を行うスタッフ専用のアカウントです。
*   **主な機能:** 割り当てられた名刺画像の閲覧、データ入力インターフェースへのアクセス。

##### 2.2.2. OperatorAdmin（入力スタッフ管理者）
Operatorの作業進捗や成果を管理するアカウントです。
*   **主な機能:**
    *   Operatorの全機能を利用可能。
    *   Operatorが入力したデータの成否や、それに基づく報酬金額を確認できる管理画面へのアクセス。
    *   ※所属スタッフ情報の更新機能は検討中（将来的に追加される可能性があります）。

#### 2.3. Admin（管理者）
ユーザーサポートやサービス全体の業務管理、納品データの最終確認を行う社内スタッフ用のアカウントです。
*   **可能な操作:**
    *   **ユーザー管理:** 全`User`アカウントの情報検索・閲覧・修正。
    *   **アンケート管理:**
        *   全てのアンケートの進捗状況（作業ステータス）を確認する。
        *   **ユーザーサポートや緊急対応のため、`User`に課せられている期間制限（会期開始後など）に関わらず、いつでもアンケート内容や設定（会期、プランなど）を修正する。**
        *   各アンケートデータのダウンロードが可能。
        *   データ化完了予定日を手動で修正する。
    *   **請求管理:** 請求金額、請求日、入金日などを手動で編集・入力する。
    *   **クーポン管理:** クーポンの発行と管理を行う。
*   **操作の制限:** 他のアカウントの権限変更はできません。

#### 2.4. MasterAdmin（上級管理者）
Adminの全権限に加え、システム全体に関わる設定が可能な最上位の権限です。
*   **可能な操作:**
    *   Adminの全ての操作。
    *   **管理系アカウントの作成・権限変更:** 管理者画面のユーザー一覧から、OperatorやOperatorAdmin、Adminといった管理系アカウントを新規作成し、役割変更に応じて権限を更新できます。
---

### 3. 権限管理フロー

#### 3.1. Userアカウント（利用者画面）
1.  **アカウント作成:** サービスを利用したいユーザー本人が、Webサイトの新規登録フォームからアカウントを作成します。
2.  **権限付与:** 作成と同時に、自動的に`User`権限が付与されます。

#### 3.2. 管理系アカウント（管理者画面）
1.  **作成依頼:** 社内での業務上、管理系アカウントが必要になった場合、`MasterAdmin`に作成を依頼します。
2.  **アカウント作成:** `MasterAdmin`が管理者画面からアカウントを新規作成し、業務内容に応じた権限（`Operator`, `Admin`など）を付与します。
3.  **権限変更:** `MasterAdmin`は、管理系アカウントの役割変更に伴い、いつでも権限を変更できます。
---

### 4. 管理者画面におけるアンケート操作ルール

最新の権限打ち合わせを踏まえ、管理者画面で実装する操作可否を以下の通り整理します。OperatorAdmin と Operator は管理者画面では閲覧のみで、アンケートの更新系操作にはアクセスできません。

| 区分 | 操作内容 | MasterAdmin | Admin | OperatorAdmin | Operator | User |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 管理者画面 | アカウント情報変更 | いつでも可能 | いつでも可能 | 権限なし | 権限なし | ステータスが会期前（会期開始日の前日まで） |
| 管理者画面 | アンケート情報変更 | いつでも可能 | いつでも可能 | 権限なし | 権限なし | ステータスが会期前（会期開始日の前日まで） |
| 管理者画面 | アンケート削除 | いつでも可能 | いつでも可能 | 権限なし | 権限なし | ステータスが会期前（会期開始日の前日まで） |
| 管理者画面 | データ化完了予定日の変更 | いつでも可能 | いつでも可能 | 権限なし | 権限なし | - |

**ステータス変更時の補足**

- 会期の開始日を前日以前に変更した場合はステータスが「会期中」または「会期後」（会期終了日が前日以前の場合）に更新され、User はアンケートの編集・削除が不可になります。
- 会期の開始日を当日に変更した場合はステータスが「会期中」となり、User はアンケートの編集・削除が不可になります。
- 会期の開始日を翌日以降に変更した場合はステータスが「会期前」となり、User はアンケートの編集・削除が可能になります。

# オペレーター管理画面 要件定義書

## 更新履歴
| 日付 | バージョン | 作成者 | 変更内容 |
| :--- | :--- | :--- | :--- |
| 2025-10-31 | 1.0 | Gemini | 初版作成 |

## 1. はじめに

### 1.1. 本書の目的
本書は、オペレーター管理画面の仕様、機能、および振る舞いを明確に定義することを目的とする。開発、品質保証、プロジェクト管理における共通の理解を形成するための基盤資料として用いる。

### 1.2. 対象読者
- プロジェクトマネージャー
- UI/UXデザイナー
- 開発エンジニア
- 品質保証エンジニア

### 1.3. スコープ

#### 1.3.1. 対象範囲
- オペレーター管理画面のUIレイアウトとコンポーネント定義
- オペレーターのCRUD（作成、読み取り、更新、削除）操作に関連する全機能
- ツールボックス内のフィルター、検索、更新ログ機能
- 上記機能に関連するモーダル、通知などのUIインタラクション

#### 1.3.2. 対象範囲外
- サーバーサイドのAPI仕様
- データベースのスキーマ定義
- 認証・認可に関するシステム全体の仕様
- インフラストラクチャに関する定義

## 2. 画面レイアウト

### 2.1. 全体レイアウト
本画面は、左側にメインコンテンツ、右側に折りたたみ可能なツールボックスを持つ2カラムレイアウトを基本とする。

```text
+------------------------------------------------+----------------------+
| ヘッダー                                       |                      |
+------------------------------------------------+                      |
|                                                |                      |
| メインコンテンツエリア                         |                      |
|                                                |                      |
|   - パンくずリスト                           |                      |
|   - 画面タイトル                             |                      |
|   - オペレーター招待ボタン                     | ツールボックス       |
|                                                |                      |
|   - オペレーター一覧テーブル                     |   - フィルター       |
|   - ページネーション                           |   - 更新ログ         |
|                                                |                      |
|                                                |                      |
+------------------------------------------------+----------------------+
| フッター                                       |                      |
+------------------------------------------------+----------------------+
```

### 2.2. コンポーネント詳細
- **ツールボックス:**
    - デフォルトで表示状態。トグルボタンにより開閉可能。
    - 幅は `34.2rem` とする。

## 3. 機能要件

### 3.1. 一覧表示機能 (Read)
- **REQ-OPM-001:** 登録されているオペレーター情報をテーブル形式で一覧表示する。
- **REQ-OPM-002:** テーブルの各列ヘッダー（氏名, メール, 権限, 総処理数, 状態）をクリックすることで、その列を基準に昇順/降順のソートを行う。再度クリックするとソート順が反転する。
- **REQ-OPM-003:** ページネーション機能を提供する。
    - 1ページあたりの表示件数を25, 50, 100件から選択できる。デフォルトは25件。
    - 総件数と表示範囲（例: 1 - 25 / 全 150件）を表示する。

### 3.2. 検索・フィルター機能 (Read)
- **REQ-OPM-010:** ツールボックス内のフィルター条件が変更されると、一覧表示はリアルタイムに更新される。
- **REQ-OPM-011:** キーワード検索フィールドに入力された文字列に対し、氏名、メール、IDを対象に部分一致・ケースインセンシティブな検索を行う。
- **REQ-OPM-012:** 検索入力には300msのデバウンスを適用し、パフォーマンスを最適化する。
- **REQ-OPM-013:** 権限、状態で複数選択によるAND絞り込みができる。
- **REQ-OPM-014:** 総完了件数で範囲指定（最小値、最大値）による絞り込みができる。
- **REQ-OPM-015:** 「リセット」ボタンをクリックすると、全てのフィルター条件が初期状態に戻る。

### 3.3. 招待機能 (Create)
- **REQ-OPM-020:** 「オペレーター招待」ボタンをクリックすると、「新規オペレーター招待」モーダルが表示される。
- **REQ-OPM-021:** モーダルでは、所属、権限、メールアドレス、オペレーター名が入力必須項目である。
- **REQ-OPM-022:** 「招待を送信」ボタンをクリックすると、入力内容でオペレーターが新規作成され、一覧の先頭に追加される。
- **REQ-OPM-023:** 作成後、モーダルは自動的に閉じる。

### 3.4. 編集機能 (Update)
- **REQ-OPM-030:** テーブルの「詳細」ボタンをクリックすると、「オペレーター情報編集」モーダルが表示される。
- **REQ-OPM-031:** モーダルには対象オペレーターの既存情報がフォームに事前入力されている。レイアウトは1カラムとする。
- **REQ-OPM-032:** 「変更を保存」ボタンをクリックすると情報が更新され、一覧表示に反映される。
- **REQ-OPM-033:** 保存後、モーダルは自動的に閉じ、画面右下に「オペレーター情報が更新されました。」というトースト通知が数秒間表示される。
- **REQ-OPM-034:** 「パスワード変更」ボタンをクリックすると、「パスワード変更」モーダルが表示される。
    - モーダルには「新しいパスワード」の入力フィールド（パスワード型）が表示される。
    - 「保存」ボタンをクリックすると、入力された内容でパスワードが更新されたことを示すトースト通知が表示される。
- **REQ-OPM-035:** 「パスワード初期化メール送信」ボタンをクリックすると、「パスワードリセットメールを送信します。よろしいですか？」という確認モーダルが表示される。
    - 「送信」ボタンをクリックすると、メールが送信されたことを示すトースト通知が表示される。

### 3.5. 削除機能 (Delete)
- **REQ-OPM-040:** テーブルの「削除」ボタンをクリックすると、「{オペレーター名}さんの情報を完全に削除します。よろしいですか？」というカスタム確認モーダルが表示される。
- **REQ-OPM-041:** モーダルで「削除」を選択すると、対象オペレーターが一覧から削除される。
- **REQ-OPM-042:** 削除後、画面右下に「削除を実行しました」というトースト通知が数秒間表示される。

### 3.6. 更新ログ機能
- **REQ-OPM-050:** ツールボックス内に、オペレーターに対する操作履歴（誰が、いつ、何をしたか）を時系列で表示する。
- **REQ-OPM-051:** ログの件数が表示領域の高さを超えた場合、領域内で縦スクロールが可能になる。表示領域は画面下部まで動的に拡張される。

## 4. 非機能要件

### 4.1. パフォーマンス
- **REQ-NFP-001:** フィルター、検索によるテーブルの再描画は、ユーザーが体感できるほどの遅延なく、即時に行われること。

### 4.2. ユーザビリティとアクセシビリティ
- **REQ-NFU-001:** すべてのモーダルは、`Esc`キーで閉じることができる。
- **REQ-NFU-002:** すべてのモーダルは、表示された際に適切な要素（入力フォームやキャンセルボタンなど）に自動的にフォーカスが移動する。
- **REQ-NFU-003:** すべてのボタン、入力フィールドには、スクリーンリーダーが読み上げるための適切なラベル (`aria-label`など) が設定されていること。

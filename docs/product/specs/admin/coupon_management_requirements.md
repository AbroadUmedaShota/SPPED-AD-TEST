# クーポン管理画面 要件定義書 (v1.0)

**文書バージョン:** 1.0  
**作成日:** 2025年10月4日  
**作成者:** [Gemini]

**改訂履歴**

| バージョン | 改訂日 | 改訂内容 | 改訂者 |
| :--- | :--- | :--- | :--- |
| 1.0 | 2025/10/04 | 初版作成 | [Gemini] |

---

## 1. 概要

### 1.1 目的
クーポンコードの発行・検索・編集を行う「クーポン管理」画面 (`03_admin/coupon-management.html`) のUIと機能要件を定義する。

### 1.2 背景
サービス利用企業向けのキャンペーンコードを管理するため、検索フォーム・一覧テーブル・詳細編集フォームを提供する必要がある。モックをもとに仕様を整理する。

### 1.3 スコープ
- クーポン検索フォーム、一覧テーブル、詳細編集フォーム。
- CSV出力、利用ログ表示、コード自動生成、新規発行導線。

---

## 2. 画面構成

### 2.1 ヘッダー
- H1「クーポン管理」と右側に「コード自動生成」ボタンを配置する。【F:03_admin/coupon-management.html†L23-L31】

### 2.2 クーポン検索
- `bg-surface` のカードに検索フォームを配置し、キーワード、ステータス、有効期限(開始/終了)を入力できるようにする。【F:03_admin/coupon-management.html†L33-L63】
- 新規クーポン発行ボタンを右上に表示し、モーダルまたは別画面を起動する。【F:03_admin/coupon-management.html†L37-L45】

### 2.3 クーポン一覧
- テーブル列: コード、名称、割引率、有効期限、利用回数、ステータス、操作。【F:03_admin/coupon-management.html†L64-L111】
- 操作列には編集・停止・詳細・履歴などのボタンを配置する。
- 上部に CSV 出力・利用ログ表示ボタンを置く。【F:03_admin/coupon-management.html†L64-L84】

### 2.4 詳細編集フォーム
- 下部に詳細フォームを配置し、コード・名称・割引率・利用回数上限・対象プラン・有効期限・備考を入力できるようにする。【F:03_admin/coupon-management.html†L112-L150】
- フォーム下に「保存」「利用停止」「利用ログ」ボタンを並列配置する。【F:03_admin/coupon-management.html†L151-L156】

---

## 3. 機能要件

### 3.1 検索・フィルタ
- キーワードはコード・名称の部分一致検索。
- ステータスは「利用可能」「利用停止」「期限切れ」の単一選択。
- 有効期限は開始・終了の両方が入力された場合のみ範囲検索する。

### 3.2 新規発行
- 「新規クーポン発行」ボタンで登録モーダルを表示し、コードの手動入力または自動生成を選択できるようにする。
- 登録成功後、一覧と詳細フォームを更新する。

### 3.3 編集
- 詳細フォームの保存ボタンで変更内容を更新する。割引率と利用回数上限は数値バリデーションを行う。
- 「利用停止」ボタンでステータスを `inactive` に変更し、履歴に記録する。

### 3.4 CSV/ログ
- CSV 出力は検索条件に基づいた一覧データを出力する。
- 「利用ログ表示」ボタンで別モーダルを開き、個別クーポンの使用履歴を表示する。

---

## 4. データモデル（例）
```json
{
  "filters": {
    "keyword": "SPRING",
    "status": "active",
    "validFrom": "2025-03-01",
    "validTo": "2025-04-30"
  },
  "coupons": [
    {
      "code": "SPRING25",
      "name": "春季キャンペーン25%OFF",
      "discount": 25,
      "validTo": "2025-04-30",
      "usage": {
        "used": 12,
        "limit": 100
      },
      "status": "active"
    }
  ],
  "selected": {
    "code": "SPRING25",
    "name": "春季キャンペーン25%OFF",
    "discount": 25,
    "usageLimit": 100,
    "plan": "Pro",
    "validTo": "2025-04-30",
    "note": "展示会出展企業向けの限定配布コードです。"
  }
}
```

---

## 5. 非機能要件
- 検索結果は 1 秒以内に表示する。
- 割引率・利用回数は0以上100以下、1以上の制約をバリデーションで保証する。
- ステータスタグはアクセシビリティ対応のためアイコン付きで表示する。

---

## 6. 将来検討事項
- 期間限定クーポンの一括更新機能。
- プランごとの利用制限ルール設定。
- 外部CRMとの同期機能（発行・消込）。

# 照合管理画面 要件定義書 (v1.0)

**文書バージョン:** 1.0  
**作成日:** 2025年10月4日  
**作成者:** [Gemini]

**改訂履歴**

| バージョン | 改訂日 | 改訂内容 | 改訂者 |
| :--- | :--- | :--- | :--- |
| 1.0 | 2025/10/04 | 初版作成 | [Gemini] |

---

## 1. 概要

### 1.1 目的
本書は名刺データ照合タスクを管理する「照合管理」画面 (`03_admin/data-entry-management.html`) のレイアウト・機能要件を定義する。優先キューの把握、フィルタリング、タスク一覧のソート、ページネーションなどを明文化する。

### 1.2 背景
照合業務では進捗や優先度別の残タスクを即時確認する必要があり、モックで実装されたUIを元に正式な要件を整理する。

### 1.3 スコープ
- KPIカード、優先度別キュー、グループ残タスク表示。
- フィルタフォーム、ソート可能な一覧テーブル、ページネーション。
- 一致判定ルールへの導線と更新メタ情報表示。

---

## 2. 画面構成

### 2.1 ヘッダー
- タイトル「照合管理」と右側に「一致判定ルール」ボタン、最終更新タイムスタンプを表示する。【F:03_admin/data-entry-management.html†L28-L35】

### 2.2 KPIサマリ
- 総件数、エスカレーション、ロック中、当日完了の4カードを表示し、`text-display-small` と色付きの数値で強調する。【F:03_admin/data-entry-management.html†L37-L60】

### 2.3 優先度別キュー
- 「優先度キュー」と「グループ別残タスク」を2カラムで表示し、各リストは `bg-surface-variant/30` のカードとして構成する。オンデマンド〜通常の件数を表示する。【F:03_admin/data-entry-management.html†L61-L108】

### 2.4 フィルタフォーム
- 「アンケート一覧」セクション上部に検索・ステータス・期間フィルタを提供する。期間フィルタは Flatpickr を利用した日付選択UIとし、開始・終了を並列配置する。【F:03_admin/data-entry-management.html†L109-L160】
- フィルターリセットボタンを右下に配置する。【F:03_admin/data-entry-management.html†L137-L160】

### 2.5 一覧テーブル
- テーブル列: アンケート名、ステータス、納品期日、オプション、総件数、一致、不一致、進捗、操作。【F:03_admin/data-entry-management.html†L161-L203】
- 各列ヘッダーに `sortable-header` クラスと `data-sort-key` 属性を付与し、昇降順切替アイコンを表示する。【F:03_admin/data-entry-management.html†L165-L178】
- テーブル本体は `tbody#reconciliation-table-body` をJSで描画する。

### 2.6 ページネーション
- 下部に表示件数セレクトとページ切替ボタン群を配置し、1ページあたり10/25/50件を選択可能とする。【F:03_admin/data-entry-management.html†L204-L230】

---

## 3. 機能要件

### 3.1 データロード
- 初期表示時に summary・queues・surveys データを取得し、各セクションへバインドする。
- 「最新化」ボタン押下でAPIを再呼び出し、カード／リスト／テーブルを再描画する。

### 3.2 フィルタ・ソート
- キーワード検索はアンケート名・グループ名・IDを対象とする。
- ステータスフィルタは固定選択肢（会期前/会期中/照合待ち/エスカレ等）で、複数選択不可。
- 列ヘッダークリックで昇順⇔降順を切り替え、選択状態を `data-sort-direction` 属性で管理する。

### 3.3 ページネーション
- 選択された件数設定と現在ページに基づきテーブル表示を制御する。
- ページ切替時、スクロール位置をテーブル先頭に戻す。

### 3.4 操作列
- 各行の操作ボタンには「照合を開く」「エスカレ対応」「詳細」を含める想定（モックではプレースホルダ）。
- ボタン操作時に対象アンケートIDをクエリパラメータに付与して遷移する。

---

## 4. データモデル（例）
```json
{
  "summary": {
    "total": 1240,
    "escalations": 18,
    "locked": 12,
    "completedToday": 84
  },
  "queues": {
    "priority": [
      { "label": "オンデマンド", "count": 24 },
      { "label": "超特急", "count": 38 },
      { "label": "特急", "count": 66 },
      { "label": "通常", "count": 144 }
    ],
    "groups": [
      { "name": "展示会A (OCR併用)", "remaining": 32 },
      { "name": "セミナーB (手入力優先)", "remaining": 21 }
    ]
  },
  "filters": {
    "keyword": "",
    "status": "all",
    "startDate": null,
    "endDate": null
  },
  "surveys": [
    {
      "id": "sv_0001_25022",
      "name": "サンプルアンケート 1",
      "status": "実施中",
      "dueDate": "2025-10-05",
      "option": "OCR",
      "total": 120,
      "matched": 110,
      "unmatched": 10,
      "progress": 0.92
    }
  ]
}
```

---

## 5. 非機能要件
- データ再読込は 3 秒以内に完了すること。
- テーブルは 2000 件まで対応できるよう仮想スクロール導入を検討する。
- 日付ピッカーはキーボード操作とアクセシビリティ要件を満たす設定で初期化する。

---

## 6. 将来検討事項
- WebSocket によるリアルタイム残件更新。
- 優先度キューのドラッグ＆ドロップによる再配列機能。
- エスカレーション連携のアラート表示と Slack 通知統合。

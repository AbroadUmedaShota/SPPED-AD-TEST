<!DOCTYPE html>
<html lang="ja">
<head>
    <title>名刺入力画面</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Materialize CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
          integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
          crossorigin="anonymous" referrerpolicy="no-referrer">
</head>
<body>

  <!-- Header -->
  <nav class="blue-grey darken-3">
    <div class="nav-wrapper" style="padding: 0 20px;">
      <a href="#" class="brand-logo">名刺入力</a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li><a id="user-email">入力者: ...</a></li>
        <li>
          <a href="#" class="tooltipped" data-position="bottom" data-tooltip="ダークモード切替" id="toggle-dark-mode">
            <i class="material-icons">brightness_4</i>
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container" style="width: 95%; max-width: none;">
    <div class="row">

      <!-- Left Panel: Image Viewer -->
      <div class="col s7" id="left-panel-container">
        <!-- Main Image Area -->
        <div id="main-image-area">
            <img id="main-image" src="../../sample/表.png" alt="名刺の表面">
        </div>

        <!-- Thumbnail Area -->
        <div class="thumbnail-wrapper center-align">
            <img id="thumbnail-image" src="../../sample/裏.png" alt="名刺の裏面サムネイル" class="tooltipped" data-position="top" data-tooltip="画像切替 (Alt+Q)">
        </div>

        <!-- Image Controls Area -->
        <div class="image-controls center-align">
            <a id="rotate-btn" class="btn-floating waves-effect waves-light blue tooltipped" data-position="top" data-tooltip="回転"><i class="material-icons">rotate_90_degrees_ccw</i></a>
            <a id="reset-btn" class="btn-floating waves-effect waves-light green tooltipped" data-position="top" data-tooltip="リセット"><i class="material-icons">refresh</i></a>
            <div class="zoom-control">
                <i id="zoom-out-btn" class="material-icons">zoom_out</i>
                <input type="range" id="zoom-slider" min="0.5" max="3" value="1" step="0.1">
                <i id="zoom-in-btn" class="material-icons">zoom_in</i>
            </div>
        </div>
      </div>

      <!-- Right Panel: Form -->
      <div class="col s5" id="right-panel-container">
        <div id="form-groups">
          
          <div class="group-section active" data-group="グループ1">
            <h5>グループ1：メールアドレス</h5>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">email</i>
              <input type="email" id="email" name="email">
              <label for="email">メールアドレス</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="email" data-input-label="メールアドレス">
                <i class="material-icons">star_border</i>
              </a>
            </div>
          </div>

          <div class="group-section" data-group="グループ2">
            <h5>グループ2：氏名</h5>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">person</i>
              <input type="text" id="last-name" name="last-name">
              <label for="last-name">姓</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="last-name" data-input-label="姓">
                <i class="material-icons">star_border</i>
              </a>
            </div>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">person_outline</i>
              <input type="text" id="first-name" name="first-name">
              <label for="first-name">名</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="first-name" data-input-label="名">
                <i class="material-icons">star_border</i>
              </a>
            </div>
          </div>

          <div class="group-section" data-group="グループ3">
            <h5>グループ3：会社情報</h5>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">business</i>
              <input type="text" id="company" name="company">
              <label for="company">会社名</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="company" data-input-label="会社名">
                <i class="material-icons">star_border</i>
              </a>
            </div>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">group_work</i>
              <input type="text" id="department" name="department">
              <label for="department">部署名</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="department" data-input-label="部署名">
                <i class="material-icons">star_border</i>
              </a>
            </div>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">work</i>
              <input type="text" id="position" name="position">
              <label for="position">役職名</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="position" data-input-label="役職名">
                <i class="material-icons">star_border</i>
              </a>
            </div>
          </div>
          
          <div class="group-section" data-group="グループ4">
            <h5>グループ4：住所</h5>
            <div class="row" style="margin-bottom: 0;">
                <div class="input-field col s9 with-suggestion">
                    <i class="material-icons prefix">markunread_mailbox</i>
                    <input type="text" id="zip" name="zip">
                    <label for="zip">郵便番号</label>
                    <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="zip" data-input-label="郵便番号">
                      <i class="material-icons">star_border</i>
                    </a>
                </div>
                <div class="input-field col s3">
                    <a href="#!" id="zip-search-btn" class="btn waves-effect waves-light tooltipped" data-position="top" data-tooltip="郵便番号から住所を検索">
                        <i class="material-icons">search</i>
                    </a>
                </div>
            </div>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">location_on</i>
              <input type="text" id="address1" name="address1">
              <label for="address1">住所1</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="address1" data-input-label="住所1">
                <i class="material-icons">star_border</i>
              </a>
            </div>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">location_city</i>
              <input type="text" id="address2" name="address2">
              <label for="address2">住所2(建物名)</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="address2" data-input-label="住所2(建物名)">
                <i class="material-icons">star_border</i>
              </a>
            </div>
          </div>

          <div class="group-section" data-group="グループ5">
            <h5>グループ5：電話番号</h5>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">phone</i>
              <input type="tel" id="tel1" name="tel1">
              <label for="tel1">電話番号1</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="tel1" data-input-label="電話番号1">
                <i class="material-icons">star_border</i>
              </a>
            </div>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">phone_in_talk</i>
              <input type="tel" id="tel2" name="tel2">
              <label for="tel2">電話番号2</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="tel2" data-input-label="電話番号2">
                <i class="material-icons">star_border</i>
              </a>
            </div>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">phone_iphone</i>
              <input type="tel" id="mobile" name="mobile">
              <label for="mobile">携帯番号</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="mobile" data-input-label="携帯番号">
                <i class="material-icons">star_border</i>
              </a>
            </div>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">print</i>
              <input type="tel" id="fax" name="fax">
              <label for="fax">FAX番号</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="fax" data-input-label="FAX番号">
                <i class="material-icons">star_border</i>
              </a>
            </div>
          </div>

          <div class="group-section" data-group="グループ6">
            <h5>グループ6：URL</h5>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">link</i>
              <input type="url" id="url" name="url">
              <label for="url">URL</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="url" data-input-label="URL">
                <i class="material-icons">star_border</i>
              </a>
            </div>
          </div>

          <div class="group-section" data-group="グループ7">
            <h5>グループ7：その他（メモ等）</h5>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">note</i>
              <textarea id="notes" name="notes" class="materialize-textarea"></textarea>
              <label for="notes">その他</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="notes" data-input-label="その他">
                <i class="material-icons">star_border</i>
              </a>
            </div>
          </div>

          <div class="group-section" data-group="グループ8">
            <h5>グループ8：フリー入力</h5>
            <div class="input-field with-suggestion">
              <i class="material-icons prefix">edit</i>
              <textarea id="free-text" name="free-text" class="materialize-textarea"></textarea>
              <label for="free-text">フリー入力</label>
              <a href="#suggestions-modal" class="manage-suggestions-btn modal-trigger" data-input-id="free-text" data-input-label="フリー入力">
                <i class="material-icons">star_border</i>
              </a>
            </div>
          </div>
        </div>

        <div id="snippet-container"></div>

        <!-- Action Controls (Timer and Buttons) -->
        <div class="fixed-action-controls">
            <div class="timer-container center-align">
                <span id="elapsed-time">経過時間: 00:00:00</span>
                <span class="stats-divider">|</span>
                <span id="card-count">処理枚数: 0</span>
                <span class="stats-divider">|</span>
                <span id="avg-time">平均時間: 0.0s</span>
            </div>
            <div class="button-group" style="margin-top: 10px;">
                <a id="suspend-button" class="btn waves-effect waves-light orange darken-2 modal-trigger tooltipped" data-position="top" data-target="suspend-modal" data-tooltip="作業終了"><i class="material-icons">exit_to_app</i></a>
                <a id="skip-button" class="btn waves-effect waves-light red lighten-1 modal-trigger tooltipped" data-position="top" data-target="skip-modal" data-tooltip="スキップ"><i class="material-icons">skip_next</i></a>
                <a id="confirm-button" class="btn-large btn-floating waves-effect waves-light green darken-1 tooltipped" data-position="top" data-tooltip="確定 (Ctrl+Enter)"><i class="material-icons">check</i></a>
            </div>
        </div>

      </div>
    </div>
  </div>


  <!-- Modals -->
  <div id="suggestions-modal" class="modal">
    <div class="modal-content">
      <h4 id="suggestions-modal-title"></h4>
      <div class="row">
        <div class="input-field col s9">
          <input type="text" id="new-suggestion-input">
          <label for="new-suggestion-input">新しい候補を追加</label>
        </div>
        <div class="col s3">
          <a href="#!" id="add-suggestion-btn" class="btn waves-effect waves-light">追加</a>
        </div>
      </div>
      <ul id="suggestions-list" class="collection">
        <!-- Suggestions will be dynamically added here -->
      </ul>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">完了</a>
    </div>
  </div>

  <div id="skip-modal" class="modal">
    <div class="modal-header">
      <i class="material-icons">skip_next</i>
      <h4>スキップ理由</h4>
    </div>
    <div class="modal-content">
      <p>スキップする理由を選択してください。</p>
      <div class="radio-group">
        <p>
          <label><input type="radio" name="skip-reason" value="not-card"><span class="grey-text text-darken-3">名刺ではない</span></label>
        </p>
        <p>
          <label><input type="radio" name="skip-reason" value="other-language"><span class="grey-text text-darken-3">対応言語外</span></label>
        </p>
        <p>
          <label><input type="radio" name="skip-reason" value="escalation"><span class="grey-text text-darken-3">エスカレーション</span></label>
        </p>
        <p>
          <label><input type="radio" name="skip-reason" value="other"><span class="grey-text text-darken-3">その他</span></label>
        </p>
      </div>
      <p id="skip-reason-error" class="red-text" style="display: none; margin-top: 10px;">スキップ理由を選択してください。</p>
      
      <div class="input-field" id="skip-reason-escalation-input" style="display: none; margin-top: 15px;">
        <textarea id="escalation-reason-text" class="materialize-textarea"></textarea>
        <label for="escalation-reason-text">エスカレーション理由を具体的に入力してください</label>
      </div>

      <div class="input-field" id="skip-reason-other-input" style="display: none; margin-top: 15px;">
        <textarea id="other-reason-text" class="materialize-textarea"></textarea>
        <label for="other-reason-text">理由を具体的に入力してください</label>
      </div>
    </div>
    <div class="modal-footer">
      <a href="#!" id="cancel-skip-button" class="modal-close waves-effect waves-green btn-flat">キャンセル</a>
      <a href="#!" id="confirm-skip-button" class="waves-effect waves-light btn red lighten-1">スキップ実行</a>
    </div>
  </div>

  <div id="suspend-modal" class="modal">
    <div class="modal-header">
      <i class="material-icons">warning</i>
      <h4>作業終了</h4>
    </div>
    <div class="modal-content">
      <p>作業を終了しますか？<br>現在表示されている画面の内容は保存されません。</p>
    </div>
    <div class="modal-footer">
      <a href="#!" id="cancel-suspend-button" class="modal-close waves-effect waves-green btn-flat">キャンセル</a>
      <a href="#!" id="confirm-suspend-button" class="waves-effect waves-light btn orange darken-2">終了</a>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // Initialize Materialize components
    M.AutoInit();

    const formElements = Array.from(document.querySelectorAll('input, textarea'));
    formElements.forEach((element, index) => {
        element.addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const nextElement = formElements[index + 1];
                if (nextElement) {
                    nextElement.focus();
                }
            }
        });
    });
});
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js" defer></script>
<!-- Materialize JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script src="suggestion.js" defer></script>
<script src="script.js" defer></script>
</body>
</html>
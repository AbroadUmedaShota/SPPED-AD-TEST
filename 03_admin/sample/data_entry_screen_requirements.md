# 名刺データ入力画面 要件定義書

**文書バージョン:** 1.1
**作成日:** 2025年10月3日
**更新者:** Gemini

## 1. 概要

本ドキュメントは、SPEED ADの管理者機能の一部である「名刺データ入力画面」に関する要件を定義する。
この画面は、オペレーター（入力者）がアップロードされた名刺画像を元に、迅速かつ正確に顧客データを入力し、リードデータの品質と納品速度を向上させることを目的とする。

## 2. ターゲットユーザー

-   社内のデータ入力オペレーター
-   業務委託先のデータ入力オペレーター

## 3. 画面設計

オペレーターの入力効率を最大化するため、画面を大きく2つの領域に分割する。UIは既存の管理者画面 (`03_admin`) との親和性を考慮し、**Tailwind CSS** と **Material Icons** をベースに構築する。

-   **左側: 名刺画像表示領域 (40%)**
-   **右側: データ入力領域 (60%)**

### 3.1. 名刺画像表示領域

-   **表示内容:**
    -   入力対象の名刺画像（表面）をデフォルトで表示する。
    -   「裏面表示」ボタンで裏面の画像に切り替え可能。
-   **機能:**
    -   **回転機能:** 「右90°回転」「左90°回転」ボタンを設置し、クリックするごとに画像を回転させる。
    -   **拡大機能:** **照合画面(BY-223)で採用されている高機能ビューアコンポーネントを共通利用**する。これにより、ドラッグでの拡大領域移動やホバーズームなど、直感的な操作を提供する。

### 3.2. データ入力領域

-   **経過時間タイマー:**
    -   オペレーターがデータ入力を開始してからの経過時間を「MM:SS」形式でリアルタイムに表示する。
    -   目標入力時間である「3分」を超えると、タイマーの文字色を赤に変更し、オペレーターに時間超過を視覚的に通知する。
    -   **入力完了時にかかった合計時間は、オペレーターの実績データとして記録され、パフォーマンス分析に利用される。**

-   **入力フォーム:**
    -   データ入力項目を以下のグループに分け、アコーディオン形式で表示する。各グループは独立して入力・保存が可能。
        -   メールアドレス
        -   氏名（姓, 名）
        -   会社名, 部署名, 役職名
        -   郵便番号, 住所1（都道府県・市区町村）, 住所2（番地・建物名）
        -   電話番号, 電話番号2, 携帯番号, FAX番号
        -   URL
        -   その他（メモ等）
        -   フリー入力
    -   最終的に、これらのグループの入力データは一つのレコードとして統合される。

-   **操作ボタン:**
    -   **確定（入力完了）:** 全ての入力が完了した際に使用する。クリックするとデータが保存され、次の入力対象名刺に遷移する。**必須項目がすべて入力されるまで、このボタンは非活性（クリック不可）状態とする。**
    -   **スキップ:** 入力が困難な場合に理由を選択して、タスクを中断・次のタスクへ移行する。
    -   **作業終了:** その日の作業を完全に終了する際に使用する。

## 4. 機能要件

### 4.1. バリデーションルール
-   **メールアドレス:** Email形式（`@`と`.`を1つ以上含む）であること。
-   **郵便番号:** ハイフンなしの7桁の半角数字であること。
-   **各種電話番号:** 半角数字とハイフン（`-`）のみ入力可能。

### 4.2. スキップ機能

-   「スキップ」ボタンをクリックすると、以下の理由を選択するためのモーダルウィンドウが表示される。
    -   名刺ではない
    -   対応言語外（日本語・英語以外など）
    -   その他（フリーテキスト入力、**100文字以内**）
-   理由を選択して「決定」ボタンを押すと、スキップ理由が記録され、現在の入力タスクは中断される。オペレーターには次の入力タスクが割り当てられる。

### 4.3. データ構造

-   入力されたデータは、`input_business_cards` テーブル（仮）に保存される。保存されるデータは以下のようなJSON構造を想定する。

```json
{
  "card_id": "c_0001",
  "operator_id": "op_012",
  "input_time_seconds": 150,
  "status": "completed", // "completed" or "skipped"
  "skip_reason": null, // or "not_a_card", "unsupported_language", "other"
  "skip_memo": null, // or "Text from 'other' input"
  "data": {
    "email": "test@example.com",
    "last_name": "山田",
    "first_name": "太郎",
    "company_name": "株式会社テスト",
    "zip_code": "1000001",
    // ... other fields
  }
}
```

## 5. 未決事項

-   各入力フィールドのより詳細なバリデーションルール（最大文字数など）。
-   「作業終了」ボタン押下後の確認画面のUIと挙動。
-   一度スキップした名刺の再割り当てに関する詳細なロジック（例：別のオペレーターに割り当てる、一定回数スキップされたらエスカレーションするなど）。

## 6. 非機能要件

-   **パフォーマンス:** データ保存、スキップ処理、次タスクへの画面遷移は、いずれもユーザー操作から**1秒以内**に完了することを目指す。
-   **アクセシビリティ:** 全ての入力フィールドとボタンは、キーボードのTabキーでフォーカス移動が可能であること。また、Enterキーによるフォームの送信やボタンの実行に対応すること。

## 7. 既存システムとの連携

-   本画面は、管理者画面の**「データ入力管理 - 一覧」(`data-entry-management.html`)** から、入力対象の名刺を選択した際に遷移して表示される。